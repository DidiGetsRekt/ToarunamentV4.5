;---------------------------------------------------------------------------
; 基本データ
;---------------------------------------------------------------------------
[Data]
life              = 1000   ;ライフ（体力ゲージ）最大値
power             = 3000   ;パワーゲージ最大値（オプション・デフォルトは3000=Lv.3）
attack            = 100    ;攻撃力（デフォルトは１００％）
defence           = 100    ;防御力（デフォルトは１００％）
fall.defence_up   = 50     ;横に倒れている時に一時的に加える防御力（％）
liedown.time      = 60     ;横に倒れている時間（フレーム）
airjuggle         = 25     ;ジャグルポイント限界値（「小ネタ.txt」参照）
sparkno           = -1     ;デフォルトのヒットスパーク（fightfxから）
guard.sparkno     = -1     ;デフォルトのガードスパーク（fightfxから）
KO.echo           = 0      ;ＫＯ時の音声（11,0）にエコーを掛けるか否か（0=掛けない,1=掛ける）
volume            = 0      ;キャラの標準の音量（最小-255・最大255）
IntPersistIndex   = 20     ;次のラウンドへ持ち越せる「Var」のアドレスの範囲を決める（※１）
FloatPersistIndex = 40     ;次のラウンドへ持ち越せる「FVar」のアドレスの範囲を決める（※１）

;---------------------------------------------------------------------------
; サイズ
;---------------------------------------------------------------------------
[Size]
xscale           = 1       ;キャラの横の大きさ（絶対値・float）
yscale           = 1       ;キャラの縦の大きさ（絶対値・float）
ground.back      = 13      ;地上にいる時の「後方の物理的な幅」
ground.front     = 10      ;地上にいる時の「前方の物理的な幅」
air.back         = 11      ;空中にいる時の「後方の物理的な幅」
air.front        = 8      ;空中にいる時の「前方の物理的な幅」
height           = 40      ;キャラの物理的な高さ（高いほど相手は飛び越しにくくなる）
attack.dist      = 120     ;相手がガード態勢に入る最低の距離
proj.attack.dist = 90      ;自分の「Projectile」に対して相手がガード態勢に入る最低の距離
proj.doscale     = 0       ;xscaleとyscaleを「Projectile」にも影響させるか否か（0=させない・1=させる）
head.pos         = 0,-30  ;キャラの標準の頭の座標（Bind系で適用される）
mid.pos          = 0,-18  ;キャラの標準の体中心の座標（Bind系で適用される）
shadowoffset     = 0       ;影のＹ軸方向の位置座標
draw.offset      = 0,0     ;キャラの表示座標（Ｘ軸,Ｙ軸）

;---------------------------------------------------------------------------
; 移動速度
;---------------------------------------------------------------------------
[Velocity]
walk.fwd     = 1.8		;前進速度（Ｘ軸・[Statedef 20]に適用される）
walk.back    = -1.6		;後退速度（Ｘ軸・[Statedef 20]に適用される）
run.fwd      = 4.7,0		;前方に走る速度（Ｘ軸,Ｙ軸・[Statedef 100]に適用される）
run.back     = -5.7,-2.8	;後方に走る速度（Ｘ軸,Ｙ軸・[Statedef 105]に適用される）
jump.neu     = 0,-10.2		;垂直ジャンプの速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
jump.back    = -2.3		;後方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
jump.fwd     = 2.5		;前方ジャンプの速度（Ｘ軸・[Statedef 40]に適用される）
runjump.back = -2.5,-10.8	;後方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
runjump.fwd  = 2.7,-10.8	;前方に走ってからのジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 40]に適用される）
airjump.neu  = 0,-8.2		;空中垂直ジャンプ速度（Ｘ軸,Ｙ軸・[Statedef 45]に適用される）
airjump.back = -2.1		;空中後方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）
airjump.fwd  = 2.3		;空中前方ジャンプ速度（Ｘ軸・[Statedef 45]に適用される）

;---------------------------------------------------------------------------
; 運動関係
;---------------------------------------------------------------------------
[Movement]
airjump.num     = 0        ;空中ジャンプが出来る回数
airjump.height  = 0       ;空中ジャンプが出来る最低の高度（Ｙ軸）
yaccel          = .5      ;Ｙ軸加速度（重力）
stand.friction  = .85      ;立っている時の摩擦係数（ステートのPhysicsが「S」の時）
crouch.friction = .82      ;しゃがんでいる時の摩擦係数（ステートのPhysicsが「C」の時）

;===========================================================================
; ステート
;===========================================================================
;---------------------------------------------------------------------------
; ここからはキャラのそれぞれの行動（ステート）を設定する。
; 番号（ステートナンバー）に気を付ければ良いだけで、
; 行動の決め方もステートの数も作りたいキャラによって自由。
;
; 本来ステートは別のファイルとして扱っているものだけど、
; このようにコンスタンツファイルと一緒にまとめる事も可能。
;
; ステートの基本的な設定はおまけフォルダの「テンプレート.txt」を参照。
;===========================================================================
; 基本行動
;===========================================================================
;---------------------------------------------------------------------------
;タイムオーバー（負けた時）
[Statedef 170]
type = S
ctrl = 0
anim = 170
velset = 0,0

[State 170, 無敵]
type = NotHitBy
trigger1 = 1 ;トリガーを何も書かず「1」にする事により、『無条件で常に実行させる命令』になる。
value = SCA
time = 1

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;勝利ポーズ分岐（common1.cnsには無いけど、これもコモンステート）
[Statedef 180]
type = S

[State 180, ステート変更]
type = ChangeState
trigger1 = Time = 0
value = 181

;---------------------------------------------------------------------------
;勝利ポーズ
[Statedef 181]
type = S
ctrl = 0
anim = 181
velset = 0,0

[State 181, 無敵]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 181]
type = PlaySnd
trigger1 = animelemTime(2) = 0
value = 0, 5
persistent = 12

[State 181]
type = explod
trigger1 = animelemTime(2) = 0
anim = 182
pos = -20, -40
postype = p1
ID = 182
sprpriority = 3
supermovetime = 9999
ownpal = 1
removeongethit = 1
persistent = 6

;---------------------------------------------------------------------------
;---------------------------------------------------------------------------
;イントロ（試合開始前の登場演出アクション）
[Statedef 191]
type = S
ctrl = 0
anim = 190
velset = 0,0

[State 191]
type = powerset
trigger1 = RoundNo = 1 && time = 0
value = 1000

[State 191, アニメ変更];バトル画面に切り替わった瞬間のフェードインの時、アニメを固定している
type = ChangeAnim
trigger1 = RoundState = 0
value = 190

[State 191, 特殊効果];試合が開始するまではこのコントローラを使おう（※２）
type = AssertSpecial
trigger1 = 1
flag = Intro ;イントロの状態

[State 191];猫
type = Explod
trigger1 = RoundState = 0
anim = 191
postype = p1
pos = -28, 0
removetime = 2

[State 191];猫
type = Explod
trigger1 = RoundState != 0
anim = 191
postype = p1
pos = -28, 0
persistent = 0
ID = 191

[State 191];猫
type = Explod
trigger1 = AnimElemTime(6) = 0
anim = 192
postype = p1
pos = -28, 0
vel = -5, 0
persistent = 0
ID = 191
removetime = 60

[State 191];汗
type = Explod
trigger1 = AnimElemTime(12) = 0
anim = 193
postype = p1
pos = 8, -40
vel = 0, 1.5
accel = 0, -.1
removetime = 15
sprpriority = 4

[State 191];汗
type = Explod
trigger1 = AnimElemTime(12) = 15
anim = 193
postype = p1
pos = 8, -28
removetime = 45
sprpriority = 4

;カンフーマンのファイルを使ってあなた自身のキャラを作っているなら、
;同じく下にある二つの「PlaySnd」のステートコントローラを消してお使いください。
;この二つは板を蹴る時の音声を再生します。

[State 191, 音を鳴らす];蹴った瞬間の音
type = PlaySnd
trigger1 = AnimElemTime(4) = 6
value = 0,5

[State 191, ステート変更];アニメーションが終われば「通常立ち」のステートに変更する
type = ChangeState
Trigger1 = Anim = 190
trigger1 = AnimTime = 0
value = 0

;---------------------------------------------------------------------------
; ※２：AssertSpecial
;
; 　他のコントローラでは設定出来ない『特殊な効果』を指定する命令。
; 　設定したトリガーが有効になってる間だけ一時的に適用される。
;
; 　適用出来るパラメータはこのコントローラを一つ設置する場合、最大３つまで。
; 　書式としては「flag」「flag2」「flag3」を順に加えていく形。
; 　flag2とflag3はオプション。ではその特殊効果を全て紹介。
;
; 　Intro          = イントロ（試合開始前の登場演出アクション）の状態になる。イントロステート専用。
; 　Invisible      = 自分の姿を消す。しかし残像（AfterImage）は消せない。
; 　RoundNotOver   = 現在のラウンドを過ぎない。勝利ポーズ専用。
; 　NoBarDisplay   = ライフバーを非表示にする。
; 　NoBG           = ステージの奥の画像を非表示にし、「真っ黒の背景」にする。
; 　NoFG           = ステージの手前の画像を非表示にする。
; 　NoStandGuard   = 立ちガードが出来なくなる。
; 　NoCrouchGuard  = しゃがみガードが出来なくなる。
; 　NoAirGuard     = 空中ガードが出来なくなる。
; 　NoAutoTurn     = 自動で振り向かない。
; 　NoJuggleCheck  = ジャグルをチェックしない。（ジャグルポイントが減らなくなる）
; 　NoKOSnd        = ＫＯ時の音声（11,0）を鳴らさないようにする。画面中に存在する全員に有効なので注意。
; 　NoKOSlow       = ＫＯ時のスローモーションを無効にする。（ＫＯ直前に有効にしないといけない）
; 　NoShadow       = 自分の影を消す。
; 　GlobalNoShadow = 画面中に存在する全てのプレイヤー（ヘルパーとProjectileも含む）の影を消す。
; 　NoMusic        = 演奏しているＢＧＭを止める。（プラグインによってはＢＧＭがバグるので要注意）
; 　NoWalk         = 歩かない。（前か後ろのキーを入力中コントロールが可能の時に勝手に[Statedef 20]にならない）
; 　TimerFreeze    = タイムカウント（制限時間）を停止する。
; 　UnGuardable    = 自分の全ての攻撃が『ガード不可』になる。
;
;---------------------------------------------------------------------------
;挑発
[Statedef 195]
type = S
movetype = I
physics = S
ctrl = 0
anim = 195+random%2
velset = 0,0
sprpriority = 2

[State 195, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 195
trigger1 = Time < 50
value = 0, 5
persistent = 12

[State 0, PlaySnd]
type = PlaySnd
trigger1 = anim = 196
trigger1 = time = 0
value = S196,0
channel = 0

[State 195]
type = explod
trigger1 = anim = 195
trigger1 = Time < 50
anim = 2806+random%6
pos = 0, -25
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,30
scale = .5,.5
ID = 2806
sprpriority = 3
supermovetime = 9999
ownpal = 1
removeongethit = 1
persistent = 6

[State 195]
type = explod
trigger1 = anim = 196
trigger1 = Time < 50
anim = 4551
pos = 50, -100
removetime = 75
postype = p1

[State 195]
type = varset
trigger1 = Time = 65 && var(6) > 1
var(6) = 1
ignorehitpause=1

[State 195, ステート変更]
type = varset
Trigger1 = var(59) > 0
Trigger1 = var(57) = 1
var(57) = 0

[State 195, ステート変更]
type = ChangeState
trigger1 = Time = 75
value = 0
ctrl = 1

;===========================================================================
; 通常攻撃技
;===========================================================================
;---------------------------------------------------------------------------
; 通常技はそんなに難しいテクニックは使ってないから、
; テンプレートを見ながら確認すれば覚えやすいと思う。
; 基本忘るべからず。
;
; ステートナンバーは、立ち技が２００〜２９９、しゃがみ技が４００〜４９９、
; ジャンプ技が６００〜６９９の間で決めて作るのが一般的。
; しかし強制じゃないので自由に作っちゃってＯＫ。
;---------------------------------------------------------------------------
[Statedef 200, 立ち弱]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 200
sprpriority = 2
facep2 = 1

[State 200, 立ち弱キャンセル]
type = ChangeAnim
trigger1 = Time = 0 && Var(2) = 201
value = 201

[State 200, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 1
value = 0, 5

[State 200, エフェクト]
type = Helper
trigger1 = animelemtime(2) = 0
ignorehitpause=1
name = "ef"
stateno = 201
pos = 0, 0
postype = p1
ownpal = 1
ID = 201

[State 200, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem = 2
attr = S, NA
guardflag = M
hitflag = MAFD
damage = ceil(30*FVar(0)*fvar(12))
priority = 1, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 0
guardsound = s1, 11
ground.type = Low
ground.slidetime = 9
ground.hittime  = 9
yaccel = .53
ground.velocity = -2.4
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -1.4*var(15)-1.4,ifelse(var(15),fvar(10),-5.5)
air.hittime = 12
down.velocity = -2.8,-2.5
ground.cornerpush.veloff = -2.4
air.cornerpush.veloff = -1.8*var(15)-1.4
down.cornerpush.veloff = -3.6
air.fall = 1
fall.yvelocity = 0
fall.recover = ifelse(p2movetype = A,0,1)
fall.recovertime = 20
getpower = ceil(30*fvar(11)*(var(21)=0)), ceil(25*fvar(11)*(var(21)=0))
givepower = ceil(10*fvar(11)), ceil(5*fvar(11))
id = StateNo

[State 200, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .65
fvar(5) = .65
ignorehitpause=1

[State 200, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 201]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1
ctrl = 0

[State 201, エフェクト]
type = Explod
trigger1 = time = 0 || time = 4 
anim = 1223+random%2
ID = 205
pos = ceil(15+time*1.5), time*2-16
postype = p1
bindtime = -1
scale = 0.15, 0.15
sprpriority = 4
ownpal = 1
removeongethit = 1

[State 201, エフェクト]
type = Explod
trigger1 = time = 2
anim = 1223+random%5
ID = 205
pos = 18, -12
postype = p1
bindtime = -1
scale = 0.15, 0.15
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause = 1
persistent = 0

[State 201, エフェクト]
type = DestroySelf
trigger1 = time = 4

;---------------------------------------------------------------------------
; 下の「立ち強パンチ」のステートを見てみましょ。
;
;「Width」のコントローラは相手や画面端を押すための『物理的な幅』を
; 一時的に伸ばしたり縮ませたりする命令。
; キャラの幅はバトル中に「Ctrl+C」を押して「判定ボックス」を表示させてる時に
; 一緒に確認出来る。「軸位置から伸びる黄緑色の線」がその幅。
;
; 後は「ChangeAnim」を使って５枚目で攻撃を当てたらすぐに６枚目に
; コマを進ませる命令をしてたり、
;『画像表示優先度』で「振りかぶる時は奥」「振り切った直後から手前」に
; モーション表示の操作をしてるくらいで、難しくない処理。
;
; これは余談だけど、Widthの読み方は「ウィッズ」。
; この解説文書いた時に初めて読み方知ったよ！　｡ﾟ(ﾟつД`ﾟ)ﾟ｡
;---------------------------------------------------------------------------
[Statedef 210, 立ち中・溜め]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 210
facep2 = 1

[State 210, 移動]
type = PosAdd
trigger1 = time = 0
x = 5

[State 210, ステート変更]
type = ChangeState
;trigger1 = Command != "hold_b"
trigger1 = Time >= 3
value = 211

[State 210, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 212

;---------------------------------------------------------------------------
[Statedef 211, 立ち中]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 211
sprpriority = 2

[State 211, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 211, 移動]
type = PosAdd
trigger1 = AnimElemTime(2) = 0
x = 5

[State 211, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(3) <= 0
trigger1 = movecontact
value = 211
elem = 3
ignorehitpause = 1
persistent = 0

[State 211, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem =2
attr = S, NA
guardflag = M
hitflag = MAFD
animtype  = Medium
damage = ceil(55*FVar(0))
priority = 2, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 3
guardsound = s1, 11
ground.type = Low
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -5
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -3.2*var(15)-3.2,ifelse(var(15),fvar(10),-6.7)
air.hittime = 13
down.velocity = -4,-2.5
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -2.8*var(15)-2.8
down.cornerpush.veloff = -5.6
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 21
getpower = ceil(90*fvar(11)*(var(21)=0)), ceil(75*fvar(11)*(var(21)=0))
givepower = ceil(30*fvar(11)), ceil(15*fvar(11))
id = StateNo

[State 211]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .8
fvar(5) = .8
ignorehitpause=1

[State 211, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 212, BE立ち中]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 212
sprpriority = 2

[State 212, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2

[State 212, 移動]
type = PosAdd
trigger1 = Time = 0
x = 4

[State 212, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 415
ID = 415
pos = 15, -18
postype = p1
scale = 2, .5
sprpriority = 4
ownpal = 1

[State 212, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = S, NA
guardflag = M
hitflag = MAFD
animtype  = Medium
damage = ceil(60*FVar(0))
priority = 2, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 2
guardsound = s1, 11
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
yaccel = .53
ground.velocity = -5
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -2.4*var(15)-2.4,ifelse(var(15),fvar(10),-5.7)
down.velocity = -4,-2.5
ground.cornerpush.veloff = -6
air.cornerpush.veloff = -2.8*var(15)-2.8
down.cornerpush.veloff = -5.6
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 23
getpower = ceil(90*fvar(11)*(var(21)=0)), ceil(75*fvar(11)*(var(21)=0))
givepower = ceil(30*fvar(11)), ceil(15*fvar(11))
id = StateNo

[State 211]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .8
fvar(5) = .8
ignorehitpause=1

[State 212, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 220, 立ち強・溜め]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 220
facep2 = 1

[State 220, ステート変更]
type = ChangeState
triggerall = time = [5,14]
Trigger1 = var(59) <= 0
trigger1 = Command != "hold_c"
;AI用記述
Trigger2 = var(59) != 0
Trigger2 = var(55) != 221
Trigger3 = var(59) != 0
Trigger3 = var(58) != 0
value = 221

[State 220, 移動]
type = VelSet
trigger1 = time >= 6
x = 3.2*(100-time*3)/100

[State 220, BEエフェクト]
type = Helper
trigger1 = time = 15
ignorehitpause=1
name = "BEef"
stateno = 6225
pos = -2, -2
postype = p1
ownpal = 1
ID = 6225

[State 220, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 222

;---------------------------------------------------------------------------
[Statedef 221, 立ち強]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 221
sprpriority = 2

[State 221, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2

[State 221, 移動]
type = PosAdd
trigger1 = animelem = 3
x = 13

[State 221, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(4) <= 0
trigger1 = movecontact
value = 221
elem = 4
ignorehitpause = 1
persistent = 0

[State 221, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = time = 0
attr = S, NA
guardflag = M
hitflag = MAFD
animtype  = Hard
damage = ceil(90*FVar(0))
priority = 3, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 2
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
yaccel = .53
ground.velocity = -5
guard.velocity = -6
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -2*var(15)-2,ifelse(var(15),fvar(10),-7.8)
down.velocity = -4,-2.5
ground.cornerpush.veloff = -7.5
air.cornerpush.veloff = -2.8*var(15)-2.8
down.cornerpush.veloff = -5.6
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 25
getpower = ceil(100*fvar(11)*(var(21)=0)), ceil(85*fvar(11)*(var(21)=0))
givepower = ceil(35*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 221, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = FVar(5)*.8
ignorehitpause=1

[State 221, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;BE立ち強
[Statedef 222]
type    = S
movetype= A
physics = S
ctrl = 0
anim = 222
sprpriority = 2

[State 222, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 222, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 11
value = 0, 2

[State 222, 移動]
type = PosAdd
trigger1 = animelem = 3
x = 8

[State 222, 移動]
type = PosAdd
trigger1 = animelem = 6
x = 13

[State 222, 無敵]
type = NotHitBy
trigger1 = AnimElemNo(0) = [2,5]
value = SCA

[State 222, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(7) <= 0
trigger1 = movecontact
value = 222
elem = 7
ignorehitpause = 1
persistent = 0

[State 222, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = S, NA
guardflag = H
hitflag = MAFD
animtype  = Hard
damage = ceil(105*FVar(0)),10
priority = 4, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 18
ground.hittime  = 18
yaccel = .53
ground.velocity = -5
guard.velocity = -6
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -2*var(15)-2,ifelse(var(15),fvar(10),-6.5)
air.hittime = 14
down.velocity = -4,-2.5
ground.cornerpush.veloff = -7.5
air.cornerpush.veloff = -2.8*var(15)-2.8
down.cornerpush.veloff = -5.6
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(120*fvar(11)*(var(21)=0)), ceil(100*fvar(11)*(var(21)=0))
givepower = ceil(40*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 222, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .5
fvar(5) = .5
ignorehitpause=1

[State 222, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 230, 立ち4強]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 230
sprpriority = 2
facep2 = 1

[State 230, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2

[State 230, 移動]
type = PosAdd
trigger1 = animelem = 3
x = 11

[State 230, 移動]
type = velset
trigger1 = animelem = 4
x = 4

[State 230, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = var(15) = 0 && movecontact = 0 && movereversed = 0
attr = S, NA
guardflag = M
hitflag = MAFD
animtype  = Hard
damage = ceil(80*FVar(0))
priority = 3, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 2
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
yaccel = .53
ground.velocity = -6
guard.velocity = -6
airguard.velocity = -3.2,-.8
air.type = High
air.velocity = -12
down.velocity = -12
ground.cornerpush.veloff = -7.5
air.cornerpush.veloff = -2.8
down.cornerpush.veloff = -5.6
p2stateno = 235
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 25
getpower = ceil(90*fvar(11)*(var(21)=0)), ceil(75*fvar(11)*(var(21)=0))
givepower = ceil(30*fvar(11)), ceil(15*fvar(11))
id = StateNo

[State 230, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = var(15) = 1 && movecontact = 0 && movereversed = 0
attr = S, NA
guardflag = M
hitflag = MAFD
animtype  = Hard
damage = ceil(80*FVar(0))
priority = 3, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 2
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
yaccel = .53
ground.velocity = -6
guard.velocity = -6
airguard.velocity = -3.2,-.8
air.type = High
air.velocity = -5,var(15)
down.velocity = -5,-2.5
ground.cornerpush.veloff = -7.5
air.cornerpush.veloff = -5.6
down.cornerpush.veloff = -5.6
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 25
getpower = ceil(90*fvar(11)*(var(21)=0)), ceil(75*fvar(11)*(var(21)=0))
givepower = ceil(30*fvar(11)), ceil(15*fvar(11))
id = StateNo

[State 230]
type = VarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = var(15) = 0
var(7) = 10
ignorehitpause=1

[State 230, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = fvar(5)*.8
ignorehitpause=1

[State 230, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 235,壁吹き飛び]
type= U
movetype= H
physics = U
ctrl = 0
sprpriority = 2
facep2 = 1

[State 235]
type = HitVelSet
trigger1 = HitShakeOver = 1
x = 1
y = 1
persistent = 0

[State 235]
type = VelSet
trigger1 = 1
y = 0

[State 235]
type = StateTypeSet
triggerall = Time = 0
trigger1 = statetype != S && statetype != C
trigger2 = gethitvar(yvel)
statetype = A
physics = N

[State 235]
type = playerpush
trigger1 = statetype = A
value = 0

[State 235]
type = posfreeze
trigger1 = HitShakeOver = 0
value = 1

[State 235]
type = posadd
trigger1 = HitShakeOver = 0
x = 1-time%2*2

[State 235, 相手のアニメ変更]
type = ChangeAnim
trigger1 = Time = 0
value = 5010

[State 235, 相手のアニメ変更]
type = ChangeAnim
trigger1 = AnimTime = -1
value = 5010
elem = animelemno(0)

[State 235, ステート変更]
type = SelfState
trigger1 = statetype != A
trigger1 = Time = 24
value = 0
ctrl = 1

[State 235, ステート変更]
type = changestate
triggerall = statetype = A
triggerall = HitShakeOver = 1
triggerall = time < 12
trigger1 = BackEdgeBodyDist <= 5 && vel X < 0
trigger2 = frontEdgeBodyDist <= 5 && vel X > 0
value = 236

[State 235, ステート変更]
type = changestate
triggerall = statetype = A
triggerall = HitShakeOver = 1
trigger1 = BackEdgeBodyDist <= 5 && vel X < 0
trigger2 = frontEdgeBodyDist <= 5 && vel X > 0
value = 237

;---------------------------------------------------------------------------
[Statedef 236]
type= U
movetype= H
physics = U
velset = 0,0
ctrl = 0
sprpriority = 2

[State 236]
type = AssertSpecial
trigger1 = 1
flag = noautoturn

[State 236]
type = turn
trigger1 = Time = 0 && FrontEdgeBodyDist <= 5

[State 236]
type = playerpush
trigger1 = Time = 0
value = 1

[State 236]
type = posadd
trigger1 = Time = 0
x = BackEdgeBodyDist

[State 236]
type = PosFreeze
trigger1 = time < 8
value = 1

[State 236]
type = ChangeAnim
trigger1 = Time = 4
value = 5010

[State 236]
type = turn
trigger1 = Time = 4

[State 236]
type = VelSet
trigger1 = Time = 8
x = -.5
y = -7.5

[State 236]
type = VelAdd
trigger1 = Time >= 8
y = .5

[State 236]
type = ChangeAnim
trigger1 = Time = 8
value = 5030

[State 236]
type = ChangeAnim
triggerAll = SelfAnimExist(5035)
trigger1 = Time = 8
trigger2 = anim = 5030
trigger2 = animtime = 0
value = 5035

[State 236]
type = ChangeAnim
triggerAll = SelfAnimExist(5050)
trigger1 =! SelfAnimExist(5035)
trigger1 = Time = 8
trigger2 = anim = 5030
trigger2 = animTime = 0
trigger3 = anim = 5035
trigger3 = animTime = 0
value = 5050

[State 236]
type = turn
trigger1 = Vel Y > -1
trigger1 = alive && CanRecover && time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"

[State 236]
type = SelfState
trigger1 = Vel Y > -1
trigger1 = alive && CanRecover && time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
value = 5210

[State 236]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
trigger1 = alive && CanRecover && time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
value = 5200

[State 236] 
Type = SelfState
Trigger1 = Vel Y > 5
Trigger1 = Pos Y >= 0
Value = 5100

;---------------------------------------------------------------------------
[Statedef 237]
type= U
movetype= H
physics = U
velset = 0,0
ctrl = 0
sprpriority = 2

[State 237]
type = AssertSpecial
trigger1 = 1
flag = noautoturn

[State 237]
type = turn
trigger1 = Time = 0 && FrontEdgeBodyDist <= 5

[State 237]
type = playerpush
trigger1 = Time = 0
value = 1

[State 237]
type = posadd
trigger1 = Time = 0
x = BackEdgeBodyDist

[State 237]
type = PosFreeze
trigger1 = time < 8
value = 1

[State 237]
type = ChangeAnim
trigger1 = Time = 4
value = 5010

[State 237]
type = turn
trigger1 = Time = 4

[State 237]
type = VelSet
trigger1 = Time = 8
x = -.5
y = -7.5

[State 237]
type = VelAdd
trigger1 = Time >= 8
y = .5

[State 237]
type = ChangeAnim
trigger1 = Time = 8
value = 5030

[State 237]
type = ChangeAnim
triggerAll = SelfAnimExist(5035)
trigger1 = Time = 8
trigger2 = anim = 5030
trigger2 = animtime = 0
value = 5035

[State 237]
type = ChangeAnim
triggerAll = SelfAnimExist(5050)
trigger1 =! SelfAnimExist(5035)
trigger1 = Time = 8
trigger2 = anim = 5030
trigger2 = animTime = 0
trigger3 = anim = 5035
trigger3 = animTime = 0
value = 5050

[State 237]
type = turn
trigger1 = alive && CanRecover && Time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"

[State 237]
type = SelfState
trigger1 = alive && CanRecover && Time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
value = 5210

[State 237]
type = SelfState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= -20
trigger1 = alive && CanRecover && Time > 8
trigger1 = Command = "recovery" || Command = "a" || Command = "b" || Command = "c" || Command = "x" || Command = "y" || Command = "z"
value = 5200

[State 237] 
Type = SelfState
Trigger1 = Vel Y > 5
Trigger1 = Pos Y >= 0
Value = 5100

;===========================================================================
;---------------------------------------------------------------------------
; ２Ｄ格ゲーでのしゃがみ通常攻撃は空中ガードが不可な作品が結構多い。
; カンフーマンも例外ではなかったみたい。
; ↓のしゃがみ弱パンチのguardflagが「L」のみになってるのに注目。
; 意味は「Low」。相手はこのしゃがみ弱パンチをガードする場合、
; 「しゃがみガードだけしか出来ない」という事になる。
;
; それ以外は簡単。
;---------------------------------------------------------------------------
;屈弱
[Statedef 400]
type    = C
movetype= A
physics = C
velset = 0,0
ctrl = 0
anim = 400
sprpriority = 2
facep2 = 1

[State 400]
type = ChangeAnim
trigger1 = Time = 0 && Var(2) = 401
value = 401

[State 400, エフェクト]
type = Helper
trigger1 = animelemtime(2) = 0
ignorehitpause=1
name = "ef"
stateno = 401
pos = 6, 0
postype = p1
ownpal = 1
ID = 401

[State 400, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 1
value = 0, 5

[State 400, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem =2
attr = C, NA
guardflag = M
hitflag = MAFD
damage = ceil(27*FVar(0)*fvar(12))
priority = 1, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 1
guardsound = s1, 11
ground.type = Low
ground.slidetime = 9
ground.hittime  = 9
yaccel = .53
ground.velocity =  -3
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -1.4*var(15)-1.4,ifelse(var(15),fvar(10),-5.7)
air.hittime = 12
down.velocity = -2.8,-2.5
ground.cornerpush.veloff = -3
air.cornerpush.veloff = -1.8*var(15)-1.8
down.cornerpush.veloff = -3.6
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 19
getpower = ceil(30*fvar(11)*(var(21)=0)), ceil(25*fvar(11)*(var(21)=0))
givepower = ceil(10*fvar(11)), ceil(5*fvar(11))
id = StateNo

[State 400]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .65
fvar(5) = .65
ignorehitpause=1

[State 400, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11 ;しゃがむステートへ（コモンステート）
ctrl = 1

[Statedef 401]
type    = C
movetype= I
physics = N
velset = 0,0
anim = 1
ctrl = 0

[State 400]
type = Explod
trigger1 = time%2 = 0
anim = 1234+random%3
ID = 1234
pos = time*4, 12
postype = p1
facing = 1-random%2*2
facing = 1-random%2*2
scale = .25, .25
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 400]
type = Explod
trigger1 = time%2 = 0
anim = 1234+random%3
ID = 1234
pos = -time*4, 12
postype = p1
facing = 1-random%2*2
facing = 1-random%2*2
scale = .25, .25
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 401, エフェクト]
type = DestroySelf
trigger1 = time = 4

;---------------------------------------------------------------------------
; 効果の違う攻撃を連続でヒットさせる場合は、複数のHitDefが必要。
; ↓のしゃがみ強パンチのguardflagの効果がそれぞれ別々（MとMA）なように、
; パラメータが数値じゃなければ特に。こればかりはどうしようもない。
;---------------------------------------------------------------------------
;屈中
[Statedef 410]
type    = C
movetype= A
physics = C
velset = 0,0
ctrl = 0
anim = 410
sprpriority = 2
facep2 = 1

[State 410, 音を鳴らす]
type = PlaySnd
trigger1 = Animelem = 4 || Animelem = 8
value = 0, 2

[State 410, 移動]
type = PosAdd
trigger1 = animelem = 8
x = 4

[State 410, エフェクト]
type = Explod
trigger1 = Animelemno(0) < 4
anim = 425
ID = 425
pos = -1, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 410, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem = 4 || animelem = 5 || animelem = 8 || animelem = 9
attr = C, NA
guardflag = L
hitflag = MAFD
damage = ceil(15*FVar(0)*fvar(12)),2
priority = 2, Hit
pausetime = animelemno(0)%4*3+3, animelemno(0)%4*3+3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 8
guardsound = s1, 11
ground.type = Low
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -2.4
airguard.velocity = -1.1,-.8
air.type = High
air.velocity = -1.4*var(15)-1.8,ifelse(var(15),fvar(10),-4.2)
air.hittime = 13
down.velocity = -2.8,-2.5
ground.cornerpush.veloff = -2.1
air.cornerpush.veloff = -1.2*var(15)-1.2
down.cornerpush.veloff = -2.4
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 20
getpower = ceil(15*fvar(11)*(var(21)=0)), ceil(12*fvar(11)*(var(21)=0))
givepower = ceil(5*fvar(11)), ceil(3*fvar(11))
id = StateNo

[State 410]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = FVar(5)*.95
ignorehitpause=1

[State 410, エフェクト]
type = Explod
trigger1 = Animelemno(0) > 11
anim = 425
ID = 425
pos = -5, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 410, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;3中
[Statedef 411]
type    = C
movetype= A
physics = C
velset = 0,0
ctrl = 0
anim = 411
sprpriority = 2
facep2 = 1

[State 411, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 1
value = 0, 2

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(1) = [0,5]
anim = 425
ID = 425
pos = -5+Animelemtime(1)*2, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(3) = [0,10]
anim = 425
ID = 425
pos = Animelemtime(3)*6, -Animelemtime(3)
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(7) = [0,4]
anim = 425
ID = 425
pos = 75-Animelemtime(7)*5, -10-Animelemtime(7)*5
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(9) = [0,4]
anim = 425
ID = 425
pos = 55-Animelemtime(9)*7, -30-Animelemtime(9)*4
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(11) = [0,4]
anim = 425
ID = 425
pos = 27-Animelemtime(11)*10, -44-Animelemtime(11)*3
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, エフェクト]
type = Explod
trigger1 = Animelemtime(13) = [0,4]
anim = 425
ID = 425
pos = Animelemtime(13)*2-17, Animelemtime(13)*4-56
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 411, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(5) = 0 || animelemtime(7) = 0 || animelemtime(9) = 0 || animelemtime(11) = 0
attr = C, NA
guardflag = MA
hitflag = MAFD
animtype = back
damage = ceil(35*FVar(0)*fvar(12)),3
pausetime = 4,6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 8
guardsound = s1, 11
ground.type = Low
ground.slidetime = 16
ground.hittime  = 16
yaccel = .45
ground.velocity = 0,-7.8
guard.velocity = -3.6
airguard.velocity = -1.6,-3
air.type = High
air.velocity = -3*var(15),ifelse(var(15),fvar(10),-7.8)
air.hittime = 14
down.velocity = -4.2,-2.5
ground.cornerpush.veloff = -1.8-AnimElemNo(0)*.1
air.cornerpush.veloff = -2*var(15)-2
down.cornerpush.veloff = -4
fall = 1
fall.yvelocity = 0
fall.recovertime = 25
getpower = ceil(15*fvar(11)*(var(21)=0)), ceil(12*fvar(11)*(var(21)=0))
givepower = ceil(5*fvar(11)), ceil(3*fvar(11))
id = StateNo

[State 411]
type = varset
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = fvar(5)*.95
ignorehitpause=1

[State 411]
type = varset
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = fvar(5) > .5
fvar(5) = .5
ignorehitpause=1

[State 411, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈強・溜め
[Statedef 420]
type    = C
movetype= A
physics = C
velset = 0,0
ctrl = 0
anim = 420
facep2 = 1

[State 420, ステート変更]
type = ChangeState
triggerall = time = [5,14]
Trigger1 = var(59) <= 0
trigger1 = Command != "hold_c"
;AI用記述
Trigger2 = var(59) != 0
Trigger2 = var(55) != 421
Trigger3 = var(59) != 0
Trigger3 = var(58) != 0
value = 421

[State 420, エフェクト]
type = Explod
trigger1 = 1
anim = 425
ID = 425
pos = -2, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 420, BEエフェクト]
type = Helper
trigger1 = time = 15
ignorehitpause=1
name = "BEef"
stateno = 6225
pos = -5, -12
postype = p1
ownpal = 1
ID = 6225

[State 420, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 422

;---------------------------------------------------------------------------
;屈強
[Statedef 421]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 421
sprpriority = 2

[State 421, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 2

[State 421, 移動]
type = PosAdd
trigger1 = AnimElem = 2 && AnimElem = 5 && AnimElem = 6
x = 4

[State 421, 移動]
type = PosAdd
trigger1 = AnimElem = 7 && AnimElem = 8 && AnimElem = 9
x = 3

[State 421, 移動]
type = VelSet
trigger1 = AnimElem = 2
x = 7

[State 421, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(4) <= 0
trigger1 = movecontact
value = 421
elem = 4
ignorehitpause = 1
persistent = 0

[State 421, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = C, NA
guardflag = L
hitflag = MAFD
animtype  = hard
damage = ceil(80*FVar(0)*fvar(12)),8
priority = 4, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 9
guardsound = s1, 11
ground.type = trip
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -.9,-3.2
guard.velocity = -9
airguard.velocity = -2.4,-.8
air.velocity = -.9*var(15)-.9,ifelse(var(15),fvar(10),-3.2)
air.hittime = 16
down.velocity = -1.8,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -3.2*var(15)-3.2
down.cornerpush.veloff = -6.4
guard.cornerpush.veloff = -11
airguard.cornerpush.veloff = -9.5
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(70*fvar(11)*(var(21)=0)), ceil(60*fvar(11)*(var(21)=0))
givepower = ceil(20*fvar(11)), ceil(10*fvar(11))
id = StateNo

[State 421]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > 0.5
fvar(5) = .5
ignorehitpause=1

[State 421, エフェクト]
type = Explod
trigger1 = animelemtime(1) < 12
anim = 425
ID = 425
pos = 15, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 421, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;BE屈強
[Statedef 422]
type    = C
movetype= A
physics = C
ctrl = 0
anim = 422
velset = 0,0
sprpriority = 2

[State 422, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 4

[State 422, 移動]
type = PosAdd
trigger1 = Animelem = 2
x = 13

[State 422, 移動]
type = VelSet
trigger1 = time = [2,16]
x = 4

[State 422, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemno(0)%3 = 1 && animelemtime(animelemno(0)) = 0 && animelemno(0) =[1,16]
attr = C, NA
guardflag = L
hitflag = MAFD
animtype  = hard
damage = ceil(35*FVar(0)*fvar(12)),3
priority = 3, Hit
pausetime = 3, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 8
guardsound = s1, 11
ground.type = trip
ground.slidetime = 10
ground.hittime  = 10
yaccel = .53
ground.velocity = -3,-2.8
guard.velocity = -5
airguard.velocity = -2.4,-.8
air.velocity = -2*var(15)-2,ifelse(var(15),fvar(10),-1.6)
air.hittime = 16
down.velocity = -4,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -3*var(15)-3
down.cornerpush.veloff = -6
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(30*fvar(11)*(var(21)=0)), ceil(25*fvar(11)*(var(21)=0))
givepower = ceil(10*fvar(11)), ceil(5*fvar(11))
id = StateNo

[State 422]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = FVar(5)*0.9
ignorehitpause=1

[State 422, エフェクト]
type = Explod
trigger1 = animelemtime(1) < 48
anim = 425
ID = 425
pos = 30-AnimElemTime(1)%6*6, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 422, エフェクト]
type = Explod
trigger1 = animelemtime(1) < 48
anim = 425
ID = 425
pos = 48-AnimElemTime(1)%6*6, 0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+0.1),-random%5*.01
facing = random%2*2-1
vfacing = random%2*2-1
scale = .5+random%3*.1, .5+random%3*.1
sprpriority = 4
ownpal = 1

[State 422, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
; ジャンプ通常攻撃にChangeStateのコントローラが無いのは、
; Physicsを「A」にしているから。
; おまけフォルダの「小ネタ.txt」を参照。（Physicsの仕組み）
;
; しゃがみ通常技とは逆に、ジャンプ通常技は基本的に「中段属性」の攻撃。
; しゃがみガードが出来ないのが普通なので、guardflagを「HA」にしておくのが定石。
;「立ちガードの需要性」と「空対地のガードの揺さぶりによる駆け引き」を
; プレイヤーに楽しんでもらうための先人達の知恵だね。
;---------------------------------------------------------------------------
;空弱
[Statedef 600]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 600
sprpriority = 2

[State 600]
type = ChangeAnim
trigger1 = Time = 0 && Var(2) = 601
value = 601

[State 600, エフェクト]
type = Explod
trigger1 = animelem = 2 || animelemtime (2) = 2
anim = 627
ID = 605
pos = 14, -35
postype = p1
bindtime = -1
scale =.25, .25
sprpriority = 4
random = 2, 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 600, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 1
value = 0, 5

[State 600, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem =2
attr = A, NA
guardflag = HA
hitflag = MAFD
damage = ceil(25*FVar(0)*fvar(12))
priority = 1, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 0
guardsound = s1, 11
ground.type = Low
ground.slidetime = 9
ground.hittime  = 9
yaccel = .53
ground.velocity = -4
air.velocity = -2.6*var(15)-1.3,ifelse(var(15),fvar(10),-6)
down.velocity = -2.6,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -1.6*var(15)-1.6
down.cornerpush.veloff = -3.2
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 22
getpower = ceil(30*fvar(11)*(var(21)=0)), ceil(25*fvar(11)*(var(21)=0))
givepower = ceil(10*fvar(11)), ceil(5*fvar(11))
id = StateNo

[State 600]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .75
fvar(5) = .75
ignorehitpause=1

[State 600, コントロール]
type = CtrlSet
trigger1 = AnimTime = 0
value = 1

;---------------------------------------------------------------------------
;空中
[Statedef 610]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 610
sprpriority = 2

[State 610, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 610, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(3) <= 0
trigger1 = movecontact
value = 610
elem = 3
ignorehitpause = 1
persistent = 0

[State 610, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem =2
attr = A, NA
guardflag = HA
hitflag = MAFD
damage = ceil(70*FVar(0))
priority = 2, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 3
guardsound = s1, 11
ground.type = High
ground.slidetime = 11
ground.hittime  = 11
yaccel = .45
ground.velocity =  -4
air.velocity = -1.8*var(15)-1.8,ifelse(var(15),fvar(10),-5.5)
air.hittime = 13
down.velocity = -3.6,-2.5
ground.cornerpush.veloff = -5
air.cornerpush.veloff = -2*var(15)-2
down.cornerpush.veloff = -4
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 22
getpower = ceil(75*fvar(11)*(var(21)=0)), ceil(60*fvar(11)*(var(21)=0))
givepower = ceil(25*fvar(11)), ceil(12*fvar(11))
id = StateNo

[State 610]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .8
fvar(5) = .8
ignorehitpause=1

;---------------------------------------------------------------------------
;空2中
[Statedef 611]
type    = A
movetype= A
physics = A
ctrl = 0
velset = 1.5,-4.5
anim = 611
sprpriority = 2

[State 611, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 2
value = 0, 1

[State 611, 音を鳴らす]
type = PlaySnd
trigger1 = time = 1
value = 0, 5

[State 611]
type = Helper
trigger1 = Time = 0
name = "spark"
stateno = 1207
pos = 30, ceil(-Pos Y)
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 611]
type = velset
trigger1 = animelemtime(9) = 0
x = 0.5
y = 9

[State 611, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(10) = 0
attr = A, NA
guardflag = HA
hitflag = MAFD
damage = ceil(60*FVar(0)*fvar(12))
priority = 2, Hit
pausetime = 8, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 3
guardsound = s1, 11
ground.type = High
ground.slidetime = 11
ground.hittime  = 16
yaccel = .55
ground.velocity =  -4
air.velocity = -1.8*var(15)-.6,ifelse(var(15),fvar(10),9)
air.hittime = 13
down.velocity = -3.6,-2.5
ground.cornerpush.veloff = -5
air.cornerpush.veloff = -2*var(15)-2
down.cornerpush.veloff = -4
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 22
getpower = ceil(75*fvar(11)*(var(21)=0)), ceil(60*fvar(11)*(var(21)=0))
givepower = ceil(25*fvar(11)), ceil(12*fvar(11))
id = StateNo

[State 611]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .6
fvar(5) = .6
ignorehitpause=1

[State 611, エフェクト]
type = Explod
trigger1 = animelemno(0) = [0,9]
anim = 622
ID = 622
pos = -13+random%20, -32+random%20
postype = p1
bindtime = -1
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 611]
type = explod
trigger1 = time%4 = 0 && animelemno(0) = [0,9]
anim = 2800+random%6
pos = -2, -21
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1

;---------------------------------------------------------------------------
;空強
[Statedef 620]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 620

[State 620, 音を鳴らす]
type = PlaySnd
trigger1 = animelem =3
value = 0, 3

[State 620, 音を鳴らす]
type = PlaySnd
trigger1 = animelem =3
value = 0, 5

[State 620, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(4) <= 0
trigger1 = movecontact
value = 620
elem = 4
ignorehitpause = 1
persistent = 0

[State 620, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = time =0
attr = A, NA
guardflag = HA
hitflag = MAFD
damage = ceil(95*FVar(0)*fvar(12))
priority = 4, Hit
pausetime = 10,10
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 2
guardsound = s1, 11
ground.type = High
ground.slidetime = 15
ground.hittime  = 15
yaccel = .45
ground.velocity = -5
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -1.5*var(15)-1.5,ifelse(var(15),fvar(10),-6.6)
down.velocity = -3,-2.5
ground.cornerpush.veloff = -6.5
air.cornerpush.veloff = -2*var(15)-2
down.cornerpush.veloff = -4
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 25
getpower = ceil(100*fvar(11)*(var(21)=0)), ceil(85*fvar(11)*(var(21)=0))
givepower = ceil(35*fvar(11)), ceil(18*fvar(11))
id = StateNo

[State 620, エフェクト]
type = Explod
trigger1 = AnimElemTime(3) = 0
anim = 628
ID = 628
pos = 0, 0
postype = p1
bindtime = -1
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 620, エフェクト]
type = Explod
trigger1 = random%2 = 0 && AnimElemTime(3) = [1,10]
anim = 627
ID = 627
pos = -23+random%60, -42+random%40
postype = p1
scale = (time*gametime%10+10)*.01,(time*gametime%10+10)*.01
sprpriority = 1+random%3
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 620]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = FVar(5)*0.9
ignorehitpause=1

;---------------------------------------------------------------------------
;空2強
[Statedef 621]
type    = A
movetype= A
physics = A
poweradd= 65
ctrl = 0
anim = 621
sprpriority = 2

[State 621, 音を鳴らす]
type = PlaySnd
trigger1 = animelem =2
value = 0, 5

[State 621, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = time%4 = 0
attr = A, NA
guardflag = HA
hitflag = MAFD
damage = ceil(25*FVar(0)*fvar(12))
priority = 3, Hit
pausetime = 4,4
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 0
guardsound = s1, 11
ground.type = High
ground.slidetime = 11
ground.hittime  = 11
yaccel = .53
ground.velocity = -4
airguard.velocity = -2.4,-.8
air.velocity = -2.4*var(15)-1.2,ifelse(var(15),fvar(10),-5.8)
down.velocity = -2.4,-2.5
ground.cornerpush.veloff = -10
air.cornerpush.veloff = -4*var(15)-4
down.cornerpush.veloff = -7
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 20
getpower = ceil(30*fvar(11)*(var(21)=0)), ceil(25*fvar(11)*(var(21)=0))
givepower = ceil(10*fvar(11)), ceil(5*fvar(11))
id = StateNo

[State 621, エフェクト]
type = Explod
trigger1 = time =[6,30] 
anim = 622
ID = 622
pos = -13+random%20, -32+random%20
postype = p1
bindtime = -1
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 621]
type = explod
trigger1 = time%2 && time = [6,30]
anim = 2800+random%6
pos = -2, -21
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1

[State 621, エフェクト]
type = Explod
trigger1 = random%2 = 0 && time =[6,30]
anim = 627
ID = 627
pos = -23+random%40, -42+random%40
postype = p1
scale = (time*gametime%10+10)*.01,(time*gametime%10+10)*.01
sprpriority = 1+random%3
ownpal = 1
removeongethit = 1
ignorehitpause=1

;---------------------------------------------------------------------------
;強制解放
[Statedef 700]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 700
sprpriority = 2
facep2 = 1

[State 700]
type = varset
trigger1 = animelemtime(4) < 0
var(22) = 30

[State 700]
type = nothitby
trigger1 = 1
value = SCA

[State 700]
type = varadd
trigger1 = animelemtime(4) = 0
var(21) = 2

[State 700]
type = varset
trigger1 = animelemtime(4) = 0
trigger1 = var(21) = 2
var(22) = 30

[State 700]
type = varset
trigger1 = animelemtime(4) = 0
trigger1 = var(21) = 3
var(22) = 60

[State 700]
type = varset
trigger1 = animelemtime(4) = 0
var(23) = power

[State 700]
type = Helper
trigger1 = animelemtime(4) = 0
name = "afterimage"
stateno = 990
supermovetime = 864000
pausemovetime = 864000
size.xscale = 1.05
size.yscale = 1.05
ownpal = 1
ID = 990
ignorehitpause=1

[State 700, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 6

[State 700, エフェクト]
type = Explod
trigger1 = animelemtime(3) = 0
anim = 705
ID = 705
pos = 0, 0
postype = p1
scale = .5,.5
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 700, エフェクト]
type = Helper
trigger1 = animelemtime(3) = [0,2]
stateno = 706
pos = 0, -40
postype = p1
bindtime = -1
ownpal = 1
ID = 706

[State 700, エフェクト]
type = Helper
trigger1 = animelemtime(4) = 0
stateno = 707
pos = 0, -40
postype = p1
bindtime = -1
ownpal = 1
ID = 707

[State 700, エフェクト]
type = Explod
trigger1 = animelemtime(3) = 0
anim = 708
ID = 708
pos = 160, 20
postype = left
scale = 2,2
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 700]
type = varset
trigger1 = animelemtime(5) = 0
var(7) = 30

[State 700]
type = PalFX
trigger1 = animelemtime(3) = [-1,13]
time = 1
add = 260-animelemtime(3)*20,260-animelemtime(3)*20,260-animelemtime(3)*20

[State 700, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(4) = 0
attr = S, ST
hitflag = MAF
damage = 0
priority = 4, Hit
pausetime = 0, 0
sparkno = -1
hitsound = s1, 5
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
yaccel = .53
ground.velocity = -12
air.velocity = -12
ground.cornerpush.veloff = 0
p2stateno = 235
fall = 1
fall.yvelocity = 0
fall.recover = 0
guard.dist = 0
id = StateNo
numhits = 0

[State 700, ステート変更]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 706]
type    = S
movetype= I
physics = N
ctrl = 0
anim = 706
sprpriority = 3

[State 706]
type = varrandom
trigger1 = time = 0
v = 0
range = 360

[State 706]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 706]
type = angledraw
trigger1 = 1
value = var(0)
scale = (time)*.005*(var(0)%4+4),(time)*.005*(var(0)%7+1)

[State 706]
type = trans
trigger1 = 1
trans = addalpha
alpha = 255-time*16,256

[State 706]
type = destroyself
trigger1 = time > 16

[Statedef 707]
type    = S
movetype= I
physics = N
ctrl = 0
anim = 707
sprpriority = 3

[State 707]
type = varrandom
trigger1 = time = 0
v = 0
range = 360

[State 707]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 707]
type = angledraw
trigger1 = 1
value = var(0)
scale = .5,.5

[State 707]
type = PalFX
trigger1 = 1
time = 1
mul = 512,512,256

[State 707]
type = trans
trigger1 = 1
trans = add

[State 707]
type = destroyself
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;地上サーキットスパーク
[Statedef 710]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 710
sprpriority = 2
facep2 = 1

[State 710]
type = nothitby
trigger1 = 1
value = SCA

[State 701]
type = poweradd
trigger1 = animelemtime(4) = 0 && var(21) = 0
value = -2000
ignorehitpause = 1

[State 701]
type = powerset
trigger1 = animelemtime(4) = 0 && var(21) = 1
value = 1000
ignorehitpause = 1

[State 701]
type = powerset
trigger1 = animelemtime(4) = 0 && var(21) = [2,3]
value = 0
ignorehitpause = 1

[State 710]
type = varset
trigger1 = animelemtime(4) = 0 && var(21) != 3
var(6) = 450

[State 710]
type = varset
trigger1 = animelemtime(4) = 0
var(21) = 0

[State 710, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 6

[State 710, エフェクト]
type = Explod
trigger1 = animelemtime(3) = 0
anim = 711
ID = 711
pos = 0, 0
postype = p1
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 710]
type = varset
trigger1 = animelemtime(5) = 0
var(7) = 30

[State 710]
type = PalFX
trigger1 = animelemtime(3) = [-1,13]
time = 1
add = 260-animelemtime(3)*20,260-animelemtime(3)*20,260-animelemtime(3)*20

[State 710]
type = bgpalfx
trigger1 = time < 4
time = 1
mul = 208-time*48,208-time*48,208-time*48

[State 710]
type = bgpalfx
trigger1 = time = [4,16]
time = 1
mul = 64,64,64

[State 710]
type = bgpalfx
trigger1 = time > 16
time = 1
mul = time*8-64,time*8-64,time*8-64

[State 710, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(3) = 0
attr = S, ST
hitflag = MAF
damage = 0
priority = 4, Hit
pausetime = 0, 0
sparkno = -1
hitsound = s1, 5
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
yaccel = .53
ground.velocity = -4,-6.2
air.velocity = -4,-6.2
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
guard.dist = 0
id = StateNo
numhits = 0

[State 710, ステート変更]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;===========================================================================
; 投げ技
;===========================================================================
;---------------------------------------------------------------------------
; エレクバイトが「作るのが退屈と感じる時もあるよ」って言ってるけど、
; 作り出したら意外とハマって楽しくなる投げ技。
; 投げる相手の正確な座標取りは面倒臭いけどね（コラ
; 投げ用のHitDefはテンプレートと見比べて確認すればわかるはず。
;---------------------------------------------------------------------------
;地上投げ
[Statedef 800]
type    = S
movetype= A
physics = S
velset = 0,0
ctrl = 0
anim = 800
sprpriority = 2
facep2 = 1

[State 800, ヒット定義（投げ用）]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = S, NT ;立ち通常投げ（Standing, Normal Throw）
hitflag = M-  ;マイナスが付加されてるので相手が食らい中の時は掴めない
priority = 1, Miss
sparkno = -1  ;-1だからヒットスパークは表示しない
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 801
p2stateno = 802
guard.dist = 0 ;相手のガード態勢に入る距離を０にしてるので、ガード不可
fall = 1
fall.yvelocity = 0
id = StateNo

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 4
value = S800,0
channel = 0

[State 800, ステート変更]
type = ChangeState
Trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;地上投げ･成功
[Statedef 801]
type    = S
movetype= A
physics = N
anim = 801

[State 801, 音を鳴らす]
type = PlaySnd
trigger1 = time=1
value = 1, 0

[State 801, 音を鳴らす]
type = PlaySnd
trigger1 = time%6=0 && time >12 && time <= 43
value = 0, 5

[State 801, 変数]
type = Turn
trigger1 = Time = 0
trigger1 = command = "holdback"

[State 801, 掴んだ相手の位置１];TargetBindで相手を一時的に拘束
type = TargetBind
trigger1 = time < 48
pos = 28, 0  ;自分の軸位置から相手の軸をX=28・Y=0の位置にする

[State 801, 掴んだ相手の向き]
type = TargetFacing
trigger1 = Time <= 1
value = -1

[State 801, 物理的なキャラの幅]
type = Width
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(2) < 0
edge = 32,0 ;画面端を押す幅を変える（オレンジの線）

[State 801, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = time%6=0 && time >=12 && time <= 42
value = floor((-5-(7-time*.15)**2)*FVar(1)*FVar(3)*fvar(12))

[State 801, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = time=48
value = floor(-30)

[State 801]
type = Helper
trigger1 = time=48
name = "spark"
stateno = 6001
pos = 15+random%30, -25-random%30
postype = p1
ownpal = 1
ID = 6002
ignorehitpause=1

[State 801]
type = TargetPowerAdd
trigger1 = time%6=0 && time >=12 && time <= 48
value = ceil(15*fvar(11))

[State -2];コンボ数
type = VarAdd
trigger1 = time%6=1 && time >=12 && time <= 48
var(14) = 1

[State 802]
type = explod
trigger1 = time >=12 && time <= 42 && time%2
anim = 2800+random%6
pos = const(size.mid.pos.x),target(800),const(size.mid.pos.y)
postype = p2
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 20,20
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1

[State -1]
type = TargetState
trigger1 = time = 48
value = 803

[State 801, 音を鳴らす]
type = PlaySnd
trigger1 = time = 49
value = 1, 5

[State 0, ChangeState]; confere se o alvo apertou o bot? pra techar, se sim, te leva pro state de tomar o tech
type = ChangeState
triggerall = NumTarget;()
triggerall = time <= 8
trigger1 = target,AILevel=0
trigger1 = target, command = "x" && (target, command = "holdfwd" || target,command = "holdback")
trigger2 = target,AILevel>0
trigger2 = random <=floor(AILevel*100/1.5)
value = 805
ctrl = 0

[State 801, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;地上投げ･相手1
[Statedef 802]
type    = A
movetype= H
physics = N
velset = 0,0

[State 802]
type = NotHitBy
trigger1 = 1
value = SCA

[State 802]
type = PalFx
trigger1 = time >=12 && time <= 42
time = 1
mul = 256,256,128

[State 802]
type = PalFx
trigger1 = time%6<2 && time >=12 && time <= 42
time = 1
mul = 192,192,0

[State 802]
type = HitOverride
trigger1 = 1
attr = ,NT
time = 1

[State 802, 相手のアニメ変更]
type = ChangeAnim
trigger1 = 1
value = 5010

[State 802, 相手ステートに戻す]
type = SelfState
trigger1 = !GetHitVar(IsBound) ;（※３）
value = 5050

;---------------------------------------------------------------------------
;地上投げ･相手2
[Statedef 803]
type    = A
movetype= H
physics = N
velset = -2.8,-7

[State 803, 相手ステートに戻す]
type = NotHitBy
trigger1 = 1
value = SCA

[State 803]
type = VelAdd
trigger1 = 1
y = .5

[State 803]
type = ChangeAnim
trigger1 = time = 0
value = 5030

[State 803]
type = ChangeAnim
triggerAll = SelfAnimExist(5035)
trigger1 = time = 0
trigger2 = anim = 5030
trigger2 = animtime = 0
value = 5035

[State 803]
type = ChangeAnim
triggerAll = SelfAnimExist(5050)
trigger1 =! SelfAnimExist(5035)
trigger1 = time = 0
trigger2 = anim = 5030
trigger2 = animTime = 0
trigger3 = anim = 5035
trigger3 = animTime = 0
value = 5050

[State -1] 
Type = SelfState
Trigger1 = Vel Y > 5
Trigger1 = Pos Y >= 0
Value = 5100

;---------------------------------------------------------------------------
; Teched Going Back - attacker state
[Statedef 805]
type    = S
movetype= H
physics = N

[State 0, StopSnd]
type = StopSnd
trigger1 =  time = 0
channel = -1
;ignorehitpause = 
;persistent = 

[State 0, TargetState]; faz o techador entrar no state do tech
type = TargetState
trigger1 = time = 0
value = 806

[State 200, PlaySnd];som de grito(?)
type = PlaySnd
trigger1 = time = 0
value = 0,14

	[State 3501,Hit Explod]
		Type=Explod
		Trigger1=time = 0
		Anim=20026
		Pos=0,0
		bindTime=-1
		PosType=back
		sprPriority=-1
		SuperMoveTime=30
		PauseMoveTime=30
		Persistent=0
 		ignorehitpause = 1

	[State 3000,????]
		Type=envColor
		Trigger1= time = 0
		value=0,0,0
		Time=13
		under=1
		Persistent=0
 		ignorehitpause = 1

[State 150, 1];anima?o
type = ChangeAnim
trigger1 = 1
value = 120

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 9
x = -6

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 14
x = -3

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 17
x = -1.5

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 21
x = 0

[State 0, ChangeState]
type = selfState
trigger1 = time = 30
value = 0
ctrl = 1

;==================================================================================
; Throw Escape - victim state
[Statedef 806]
type    = S                      ;State-type: S-stand, C-crouch, A-air, L-liedown
movetype= A                      ;Move-type: A-attack, I-idle, H-gethit
physics = S                      ;Physics: S-stand, C-crouch, A-air
velset = 0,0                     ;Set velocity (x,y) (Def: no change)
ctrl = 0                         ;Set ctrl (Def: no change)
poweradd = 0                    ;Power to add (Def: 0)
sprpriority = 2                  ;Set p1's sprite layering priority to 2 (in front)

[State 0, ChangeAnim2]
type = ChangeAnim
trigger1 = 1
value = 120
;elem = 1
;ignorehitpause = 
;persistent = 


[State 0, PosSet];fique no ch? agora
type = PosSet
trigger1 = time = 0
y = 0

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 9
x = -6

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 14
x = -3

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 17
x = -1.5

[State 0, VelSet];pushback
type = VelSet
trigger1 = time = 21
x = 0

[State 200, 3]; vai pro state 0 e faz tudo voltar ao normal (n?)
type = selfState
trigger1 = time = 33
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;空投げ
[Statedef 810]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 810
sprpriority = 2

[State 810, ヒット定義（投げ用）]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = A, NT ;立ち通常投げ（Standing, Normal Throw）
hitflag = AF  ;マイナスが付加されてるので相手が食らい中の時は掴めない
priority = 1, Miss
sparkno = -1  ;-1だからヒットスパークは表示しない
p1sprpriority = 1
p1facing = 1
p2facing = 1
p1stateno = 811
p2stateno = 812
guard.dist = 0 ;相手のガード態勢に入る距離を０にしてるので、ガード不可
fall = 1
fall.yvelocity = 0
givepower = ceil(50*fvar(11)), ceil(25*fvar(11))
id = StateNo

[State 810]
type = CtrlSet
trigger1 = time = 3
value = 1

;---------------------------------------------------------------------------
[Statedef 811]
type    = A
movetype= A
physics = A
anim = 811

[State 811]
Type = VelSet
trigger1 = Anim = 811
trigger1 = animelemtime(6) < 0
X = 0
Y = 0

[State 811, 音を鳴らす]
type = PlaySnd
trigger1 = time=1
value = 1, 0

[State 811, 変数]
type = Turn
trigger1 = Time = 0
trigger1 = command = "holdback"

[State 811, 掴んだ相手の位置１];TargetBindで相手を一時的に拘束
type = TargetBind
trigger1 = Anim = 811
trigger1 = animelemtime(6) < 0
pos = 28, -target(810),const(size.mid.pos.y)*.5-5

[State 811, 掴んだ相手の向き]
type = TargetFacing
trigger1 = Time <= 1
value = -1

[State 811, 物理的なキャラの幅]
type = Width
trigger1 = Anim = 811
trigger1 = AnimElemTime(1) >= 0 && AnimElemTime(6) < 0
edge = 32,0 ;画面端を押す幅を変える（オレンジの線）

[State 811, 掴んだ相手のライフ増減]
type = TargetLifeAdd
trigger1 = time = 45
value = floor(-120*FVar(1)*FVar(3)*FVar(5)*fvar(12))

[State 811]
type = TargetPowerAdd
trigger1 = time = 45
value = ceil(120*fvar(11))

[State 811];コンボ数
type = VarAdd
trigger1 = time = 45
var(14) = 1

[State 811, 掴んだ相手のステート変更]
type = TargetState
trigger1 = Anim = 811
trigger1 = animelemtime(6) = 0
value = 813

[State 811, 音を鳴らす]
type = PlaySnd
trigger1 = Anim = 811
trigger1 = animelemtime(6) = 0
value = 0, 3

[State 811]
type = VelSet
trigger1 = Anim = 811
trigger1 = animelemtime(6) = 0
x = -2.1
y = -7.4

[State 811]
type = Helper
trigger1 = time = 41
ignorehitpause=1
name = "lightning"
stateno = 815
pos = 0, target(810),const(size.mid.pos.y)
postype = p2
bindtime = 4
ownpal = 1
ID = 2000

[State 811]
type = ChangeAnim
trigger1 = time > 21
trigger1 = Vel y > -2
persistent = 0
value = 46

[State 811]
Type = ChangeState
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 52

;---------------------------------------------------------------------------
;空投げ･相手1
[Statedef 812]
type    = A
movetype= H
physics = N
velset = 0,0

[State 812, 相手のアニメ変更]
type = ChangeAnim2
trigger1 = 1
value = 5000

[State 812, 相手ステートに戻す]
type = NotHitBy
trigger1 = 1
value = SCA

[State 812, 相手ステートに戻す]
type = SelfState
trigger1 = !GetHitVar(IsBound) ;（※３）
value = 5050

;---------------------------------------------------------------------------
;空投げ･相手2
[Statedef 813]
type    = A
movetype= H
physics = N
velset = -2.4,-5

[State 813, 相手ステートに戻す]
type = NotHitBy
trigger1 = time = 0
value = SCA
time = 50

[State 813]
type = VelAdd
trigger1 = 1
y = ifelse(time<29,.5,.6)

[State 813]
type = VelSet
trigger1 = time = [25,28]
x = 0
y = 0

[State 813]
type = VelSet
trigger1 = time = 29
x = -1.6
y = -6.5

[State 803]
type = ChangeAnim
trigger1 = time = 0 || time = 25
value = 5030

[State 803]
type = ChangeAnim
triggerAll = SelfAnimExist(5035)
trigger1 = time = 0 || time = 25
trigger2 = anim = 5030
trigger2 = animtime = 0
value = 5035

[State 803]
type = ChangeAnim
triggerAll = SelfAnimExist(5050)
trigger1 =! SelfAnimExist(5035)
trigger1 = time = 0 || time = 25
trigger2 = anim = 5030
trigger2 = animTime = 0
trigger3 = anim = 5035
trigger3 = animTime = 0
value = 5050

[State -1]
type = SelfState
trigger1 = time > 30
trigger1 = Vel Y > 0
trigger1 = Pos Y >= 0
value = 5100

;---------------------------------------------------------------------------
[Statedef 815]
type     = S
movetype = I
physics  = N
ctrl     = 0
anim     = 815
sprpriority = 3

[State 815]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 815]
Type = AssertSpecial
Trigger1 = 1
Flag = Noshadow
IgnoreHitPause = 1

[State 815]
type = AngleDraw
trigger1 = 1
scale = 0.5, 0.5

[State 815]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 815, 音を鳴らす]
type = PlaySnd
trigger1 = time = 0
value = 0, 6

[State 815, 音を鳴らす]
type = PlaySnd
trigger1 = time = 4
value = 1, 7

[State 815]
type = Helper
trigger1 = time = 4
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = 10-Random%20, 5-Random%20
postype = p2
ownpal = 1
ID = 6000

[State 815]
type = explod
trigger1 = time = 4
anim = 2425
pos = 0, 0
postype = p1
scale = .75,.75
ID = 2425
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 815]
type = bgpalfx
trigger1 = time < 4
time = 1
mul = 208-time*48,208-time*48,208-time*48

[State 815]
type = bgpalfx
trigger1 = time = [4,7]
time = 1
add = 64,64,64

[State 815]
type = bgpalfx
trigger1 = time = [8,13]
time = 1
mul = 64,64,64

[State 815]
type = bgpalfx
trigger1 = time > 13
time = 1
mul = time*8-32,time*8-32,time*8-32

[State 815]
type = DestroySelf
trigger1 = time = 35
trigger2 = NumHelper(2500)

;---------------------------------------------------------------------------
;避け
[Statedef 850] 
type     = S
movetype = I
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 850

[State 850]
type = playerpush
trigger1 = 1
value = 0

[State 850]
type = PalFX
trigger1 = time = [1,20]
time = 1
add = 200-time*10,200-time*10,200-time*10

[State -1]
type = nothitby
trigger1 = time = [1,24]
value = ,AA,AT
ignorehitpause = 1

[State 850, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Exシールド
[Statedef 900] 
type     = S
movetype = I
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 900

[State 900, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 950
pos = 22,-17
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 950

[State 900, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 951
pos = 22,-17
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 900]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 900]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = [1,4]
trigger2 = var(21) = 3 && hitpausetime > 1
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 900, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 900, 0
ignorehitpause = 1

[State 900]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 900
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 900]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 900]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 900, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno != [400,409]
trigger1 = movecontact = 0
reversal.attr = SA, AA, AP
pausetime     = 13,4
numhits       = 0
sparkno       = -1
hitsound      = S901,0
getpower = 50*(var(21)=0),0
ignorehitpause = 1

[State 900, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno = [400,409]
trigger1 = movecontact = 0
reversal.attr = SCA, AA, AP
pausetime     = 13,4
numhits       = 0
sparkno       = -1
hitsound      = S901,0
getpower = 50*(var(21)=0),0
ignorehitpause = 1

[State 900, 受け止め定義]
type = ReversalDef
trigger1 = var(21) = 3 && movecontact = 1
reversal.attr = SCA, AP
ignorehitpause = 1

[State 900]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AP
stateno = 901
ignorehitpause = 1

[State 900, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 47-random%50,-7-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 900]
type = changeanim
trigger1 = movehit && hitpausetime = 0 && animelemno(0) = 2
value = 900
elem = 3
ignorehitpause = 1

[State 900, ステート変更]
type = ChangeState
trigger1 = movehit && animelemtime(3) = 0 && var(21) = 3
value = 3100
ignorehitpause = 1

[State 900, ステート変更]
type = ChangeState
trigger1 = movehit = 0
trigger1 = command = "hold_z" && time = 5 && anim = 900
value = 902
ignorehitpause = 1

[State 900, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;Exシールドp-counter
[Statedef 901] 
type     = S
movetype = I
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 900

[State 901]
type = VarSet
trigger1 = time = 13
var(2) = 900
ignorehitpause=1
supermovetime = 36

[State 901]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 901]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 901]
type = poweradd
trigger1 = time = 0
value = 50*(var(21)=0)
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = var(21) = 3
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 901, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 0
ignorehitpause = 1

[State 901]
type = changeanim
trigger1 = time < 13
value = 900
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 901]
type = changeanim
trigger1 = time = 13
value = 900
elem = 3
ignorehitpause = 1

[State 901]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 901, 受け止め定義]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AA, AP
stateno = 901
ignorehitpause = 1

[State 901, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 47-random%50,-7-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 901, ステート変更]
type = ChangeState
trigger1 = time = 13 && var(21) = 3
value = 3100
ignorehitpause = 1

[State 901, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;シールド
[Statedef 902] 
type     = S
movetype = I
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 902

[State 902, エフェクト]
type = Explod
trigger1 = numexplod(951) = 0 && anim = 902
anim = 951
pos = 22,-17
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 902]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 902]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = 1
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 902]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 902
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 902]
type = changeanim
triggerall = Anim != 903 && hitpausetime = 0
trigger1 = command != "hold_z"
trigger2 = time = 90
trigger3 = movehit
trigger4 = power = 0
value = 903
elem = 1
ignorehitpause = 1

[State 902]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 902]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 902, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno != [400,409]
trigger1 = movecontact = 0
reversal.attr = SA, AA, AP
pausetime     = 13,0
numhits       = 0
sparkno       = -1
hitsound      = S901,1
getpower = 50*(var(21)=0),0
ignorehitpause = 1

[State 902, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno = [400,409]
trigger1 = movecontact = 0
reversal.attr = SCA, AA, AP
pausetime     = 13,0
numhits       = 0
sparkno       = -1
hitsound      = S901,1
getpower = 50*(var(21)=0),0
ignorehitpause = 1

[State 902]
type = hitoverride
trigger1 = p2stateno != [400,409]
trigger1 = anim = 902
attr = SCA, AP
stateno = 903
ignorehitpause = 1

[State 902]
type = hitoverride
trigger1 = p2stateno = [400,409]
trigger1 = anim = 902
attr = SCA, AP
stateno = 903
ignorehitpause = 1

[State 902, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 47-random%50,-7-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 902]
type = poweradd
trigger1 = Anim = 902
value = -12*(var(21)=0)

[State 902, ステート変更]
type = ChangeState
trigger1 = Anim = 903 && AnimTime = 0
value = 0
ctrl = 1
ignorehitpause = 1

;---------------------------------------------------------------------------
;Exシールドp-counter
[Statedef 903] 
type     = S
movetype = I
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 902

[State 903]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 903]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 903]
type = poweradd
trigger1 = time = 0
value = 50*(var(21)=0)
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State 903, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 1
ignorehitpause = 1

[State 903]
type = changeanim
trigger1 = time < 13
value = 902
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 903]
type = changeanim
trigger1 = time = 13
value = 903
elem = 1
ignorehitpause = 1

[State 903]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 903, 受け止め定義]
type = hitoverride
trigger1 = time < 13
attr = SCA, AA, AP
stateno = 903
ignorehitpause = 1

[State 903, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 47-random%50,-7-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 903, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;屈Exシールド
[Statedef 910] 
type     = C
movetype = I
physics  = C
ctrl     = 0
velset   = 0,0
anim     = 910

[State 910, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 950
pos = 18,-14
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 950

[State 910, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 951
pos = 18,-14
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 910]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 910]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = [1,4]
trigger2 = var(21) = 3 && hitpausetime > 1
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 910, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 900, 0
ignorehitpause = 1

[State 910]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 910
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 910]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 910]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 910, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno != [200,209]
trigger1 = p2stateno != [600,609]
trigger1 = movecontact = 0
reversal.attr = C, AA, AP
pausetime     = 13,4
numhits       = 0
sparkno       = -1
hitsound      = S901,0
getpower = 50,0

[State 910, 受け止め定義]
type = ReversalDef
triggerall = movecontact = 0
trigger1 = p2stateno = [200,209]
trigger2 = p2stateno = [600,609]
reversal.attr = SCA, AA, AP
pausetime     = 13,4
numhits       = 0
sparkno       = -1
hitsound      = S901,0
getpower = 50,0

[State 910, 受け止め定義]
type = ReversalDef
trigger1 = var(21) = 3 && movecontact = 1
reversal.attr = SCA, AP
ignorehitpause = 1

[State 910]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AP
stateno = 911
ignorehitpause = 1

[State 910, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 43-random%50,1-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 910]
type = changeanim
trigger1 = movehit && hitpausetime = 0 && animelemno(0) = 2
value = 910
elem = 3
ignorehitpause = 1

[State 910, ステート変更]
type = ChangeState
trigger1 = movehit && animelemtime(3) = 0 && var(21) = 3
value = 3100
ignorehitpause = 1

[State 910, ステート変更]
type = ChangeState
trigger1 = movehit = 0
trigger1 = command = "hold_z" && time = 5 && anim = 910
value = 912
ignorehitpause = 1

[State 910, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈Exシールドp-counter
[Statedef 911] 
type     = C
movetype = I
physics  = C
ctrl     = 0
velset   = 0,0
anim     = 910

[State 911]
type = VarSet
trigger1 = time = 13
var(2) = 910
ignorehitpause=1
supermovetime = 36

[State 911]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 911]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 911]
type = poweradd
trigger1 = time = 0
value = 50
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = var(21) = 3
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 911, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 0
ignorehitpause = 1

[State 911]
type = changeanim
trigger1 = time < 13
value = 910
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 911]
type = changeanim
trigger1 = time = 13
value = 910
elem = 3
ignorehitpause = 1

[State 911]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 911]
type = hitoverride
trigger1 = p2stateno != [200,209]
trigger1 = p2stateno != [600,609]
trigger1 = animelemno(0) = 2
attr = SA, AA, AP
stateno = 911
ignorehitpause = 1

[State 911]
type = hitoverride
triggerall = animelemno(0) = 2
trigger1 = p2stateno = [200,209]
trigger2 = p2stateno = [600,609]
attr = SCA, AA, AP
stateno = 911
ignorehitpause = 1

[State 911, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 43-random%50,1-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 911, ステート変更]
type = ChangeState
trigger1 = time = 13 && var(21) = 3
value = 3100
ignorehitpause = 1

[State 911, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;屈シールド
[Statedef 912] 
type     = C
movetype = I
physics  = C
ctrl     = 0
velset   = 0,0
anim     = 912

[State 912, エフェクト]
type = Explod
trigger1 = numexplod(951) = 0 && anim = 912
anim = 951
pos = 18,-14
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 912]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 912]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = 1
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 912]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 912
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 912]
type = changeanim
triggerall = Anim != 913 && hitpausetime = 0
trigger1 = command != "hold_z"
trigger2 = time = 90
trigger3 = movehit
trigger4 = power = 0
value = 913
elem = 1
ignorehitpause = 1

[State 912]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 912]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 912, 受け止め定義]
type = ReversalDef
trigger1 = p2stateno != [200,209]
trigger1 = p2stateno != [600,609]
trigger1 = movecontact = 0
reversal.attr = C, AA, AP
pausetime     = 13,0
numhits       = 0
sparkno       = -1
hitsound      = S901,1
getpower = 50,0

[State 912, 受け止め定義]
type = ReversalDef
triggerall = movecontact = 0
trigger1 = p2stateno = [200,209]
trigger2 = p2stateno = [600,609]
reversal.attr = SCA, AA, AP
pausetime     = 13,0
numhits       = 0
sparkno       = -1
hitsound      = S901,1
getpower = 50,0

[State 912]
type = hitoverride
trigger1 = p2stateno != [200,209]
trigger1 = p2stateno != [600,609]
trigger1 = animelemno(0) = 2
attr = SCA, AP
stateno = 913
ignorehitpause = 1

[State 912]
type = hitoverride
triggerall = animelemno(0) = 2
trigger1 = p2stateno = [200,209]
trigger2 = p2stateno = [600,609]
attr = SCA, AP
stateno = 913
ignorehitpause = 1

[State 912, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 43-random%50,1-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 912]
type = poweradd
trigger1 = Anim = 912
value = -12

[State 912, ステート変更]
type = ChangeState
trigger1 = Anim = 913 && AnimTime = 0
value = 11
ctrl = 1
ignorehitpause = 1

;---------------------------------------------------------------------------
;屈シールドp-counter
[Statedef 913] 
type     = C
movetype = I
physics  = C
ctrl     = 0
velset   = 0,0
anim     = 912

[State 913]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 913]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 913]
type = poweradd
trigger1 = time = 0
value = 50
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State 913, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 1
ignorehitpause = 1

[State 913]
type = changeanim
trigger1 = time < 13
value = 912
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 913]
type = changeanim
trigger1 = time = 13
value = 913
elem = 1
ignorehitpause = 1

[State 913]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 913, 受け止め定義]
type = hitoverride
trigger1 = time < 13
attr = SCA, AA, AP
stateno = 913
ignorehitpause = 1

[State 913, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 47-random%50,-7-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 913, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 11
ctrl = 1

;---------------------------------------------------------------------------
;空Exシールド
[Statedef 920] 
type     = A
movetype = I
physics  = A
ctrl     = 0
anim     = 920

[State 920, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 950
pos = 18,-19
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 950

[State 920, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 951
pos = 18,-19
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 920]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 920]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = [1,4]
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 920, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 900, 0
ignorehitpause = 1

[State 920]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 920
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 920]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 920]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 920, 受け止め定義]
type = ReversalDef
trigger1 = movecontact = 0
reversal.attr = SCA, AA,AP
pausetime     = 13,4
numhits       = 0
sparkno       = -1
hitsound      = S901,0
getpower = 50,0

[State 920]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AA, AP
stateno = 921
ignorehitpause = 1

[State 920, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 47-random%50,6-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 920]
type = changeanim
trigger1 = movehit && hitpausetime = 0 && animelemno(0) = 2
value = 920
elem = 3
ignorehitpause = 1

[State 920, ステート変更]
type = ChangeState
trigger1 = movehit = 0
trigger1 = command = "hold_z" && time = 5 && anim = 920
value = 922
ignorehitpause = 1

;---------------------------------------------------------------------------
;空Exシールドp-counter
[Statedef 921] 
type     = A
movetype = I
physics  = A
ctrl     = 0
anim     = 920

[State 921]
type = VarSet
trigger1 = time = 13
var(2) = 920
ignorehitpause=1
supermovetime = 36

[State 921]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 921]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 921]
type = poweradd
trigger1 = time = 0
value = 50
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State 921, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 0
ignorehitpause = 1

[State 921]
type = changeanim
trigger1 = time < 13
value = 920
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 921]
type = changeanim
trigger1 = time = 13
value = 920
elem = 3
ignorehitpause = 1

[State 921]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 921]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AA, AP
stateno = 921
ignorehitpause = 1

[State 921, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 47-random%50,6-random%50
bindtime = -1
stateno = 940
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

;---------------------------------------------------------------------------
;空シールド
[Statedef 922] 
type     = A
movetype = I
physics  = A
ctrl     = 0
anim     = 922

[State 922, エフェクト]
type = Explod
trigger1 = numexplod(951) = 0 && anim = 922
anim = 951
pos = 18,-14
postype = p1
bindtime = -1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 951

[State 922]
type = RemoveExplod
trigger1 = movehit
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 922]
type = RemoveExplod
trigger1 = command != "hold_z" && time > 4
trigger2 = movehit
ID = 951
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = movehit = 1
value = SCA
ignorehitpause = 1
supermovetime = 36

[State 922]
type = changeanim
trigger1 = movehit && hitpausetime = 12
value = 922
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 922]
type = changeanim
triggerall = Anim != 923 && hitpausetime = 0
trigger1 = command != "hold_z"
trigger2 = time = 90
trigger3 = movehit
trigger4 = power = 0
value = 923
elem = 1
ignorehitpause = 1

[State 922]
type = Pause
trigger1 = movehit && hitpausetime = 12
trigger1 = target,ishelper = 0
time = 13
movetime = 13
ignorehitpause = 1

[State 922]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

;こちらは相手のHitDef用
[State 922, 受け止め定義]
type = ReversalDef
trigger1 = movecontact = 0
reversal.attr = SAC, AA, AP
pausetime     = 13,0
numhits       = 0
sparkno       = -1
hitsound      = S901,1
getpower = 50,0

[State 922]
type = hitoverride
trigger1 = animelemno(0) = 2
attr = SCA, AA, AP
stateno = 923
ignorehitpause = 1

[State 922, エフェクト]
type = helper
trigger1 = movehit && hitpausetime = 12
ID = 940
pos = 47-random%50,6-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

[State 922]
type = poweradd
trigger1 = Anim = 922
value = -12

;---------------------------------------------------------------------------
;空シールドp-counter
[Statedef 923] 
type     = A
movetype = I
physics  = A
ctrl     = 0
anim     = 922

[State 923]
type = RemoveExplod
trigger1 = time = 0
ID = 950
ignorehitpause = 1
supermovetime = 36

[State 923]
type = RemoveExplod
trigger1 = time = 0
ID = 951
ignorehitpause = 1
supermovetime = 36

[State 923]
type = poweradd
trigger1 = time = 0
value = 50
ignorehitpause = 1
supermovetime = 36

[State -1]
type = nothitby
trigger1 = time < 13
value = ,AT
ignorehitpause = 1
supermovetime = 36

[State 923, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 901, 1
ignorehitpause = 1

[State 923]
type = changeanim
trigger1 = time < 13
value = 922
elem = 2
ignorehitpause = 1
supermovetime = 36

[State 923]
type = changeanim
trigger1 = time = 13
value = 923
elem = 1
ignorehitpause = 1

[State 923]
type = TargetDrop
trigger1 = numtarget > 0
keepone = 1
ignorehitpause = 1
supermovetime = 36

[State 923, 受け止め定義]
type = hitoverride
trigger1 = time < 13
attr = SCA, AA, AP
stateno = 923
ignorehitpause = 1

[State 923, エフェクト]
type = helper
trigger1 = time = 0
ID = 940
pos = 47-random%50,6-random%50
bindtime = -1
stateno = 941
ownpal = 1
pausemovetime = 20
supermovetime = 20
ignorehitpause = 1

;---------------------------------------------------------------------------
;シールドバンカー
[Statedef 930]
type     = S
movetype = A
physics  = S
ctrl     = 0
velset   = 0,0
anim     = 930

[State 930]
type = PowerAdd
trigger1 = time = 0
trigger1 = prevstateno = 151 || prevstateno = 153
value = -500*(var(21)=0)

[State 930, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 950
pos = 12,-14
postype = p1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 950
pausemovetime = 10

[State 930, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
value = 900, 0

[State 930, 音を鳴らす]
type = PosAdd
trigger1 = time = 0
x = 12

[State 930, エフェクト]
type = PosAdd
trigger1 = time = 1
x = 8
ignorehitpause = 1

[State 930, 受け止め定義]
type = ReversalDef
trigger1 = animelemno(0) = 1
reversal.attr = SCA, AA,AP
pausetime     = 10,0
numhits       = 0
sparkno       = -1
hitsound      = -1
p1stateno = 932

[State 930, 受け止め定義]
type = HitOverride
trigger1 = animelemno(0) = 1
attr = SCA, AA,AP
stateno = 932

[State 930, ステート変更]
type = ChangeState
trigger1 = AnimElemNo(0) = 2
value = 931
ctrl = 0

;---------------------------------------------------------------------------
[Statedef 931] 
type     = S
movetype = A
physics  = S
ctrl     = 0
velset   = 0,0

[State 931]
type = PosAdd
trigger1 = animelemno(0) = 4
x = 12

[State 931]
type = PosAdd
trigger1 = animelemno(0) = 5
x = 8
ignorehitpause = 1
persistent = 0

[State 931]
type = playerpush
trigger1 = animelemno(0) < 6
value = 0

[State 931, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(5) <= 0
trigger1 = movecontact
value = 930
elem = 5
ignorehitpause = 1
persistent = 0

[State 931, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(3) = 0
attr = S, SA
guardflag = M
hitflag = MAFD
damage = ceil(55*FVar(0))
priority = 4, Hit
pausetime = 10, 10
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 5
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .53
ground.velocity = -2.1,-7.2
airguard.velocity = -2.1,-5.5
air.velocity = -2.1*var(15)-2.1,ifelse(var(15),fvar(10),-6.5)
down.velocity = -4.2,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recovertime = 20
getpower = ceil(100*fvar(11)*(var(21)=0)), ceil(85*fvar(11)*(var(21)=0))
givepower = ceil(35*fvar(11)), ceil(18*fvar(11))
id = StateNo

[State 931]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .45
fvar(5) = .45
ignorehitpause=1

[State 931, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 932] 
type     = S
movetype = A
physics  = S
ctrl     = 0
velset   = 0,0

[State 932]
type = Pause
trigger1 = time = 0 && hitpausetime = 9
trigger1 = numtarget > 0 && target,ishelper = 0
time = 10
movetime = 10
ignorehitpause = 1

[State 932, エフェクト]
type = Explod
triggerall = time = 0
trigger1 = numtarget > 0 && hitpausetime = 9
trigger2 = numtarget = 0
anim = 960
pos = 12,-14
postype = p1
sprpriority = 3
removeongethit = 1
ownpal = 1
ID = 960
ignorehitpause = 1
pausemovetime = 36
persistent = 0

[State 932, ステート変更]
type = playsnd
triggerall = time = 0
trigger1 = numtarget > 0 && hitpausetime = 9
trigger2 = numtarget = 0
value = 901,1
ignorehitpause = 1
persistent = 0

[State 932]
type = poweradd
triggerall = time = 0
trigger1 = numtarget > 0 && hitpausetime = 9
trigger2 = numtarget = 0
value = 20*(var(21)=0)
ignorehitpause = 1
persistent = 0

[State 932, エフェクト]
type = PosAdd
trigger1 = numtarget > 0 && hitpausetime = 9
trigger2 = numtarget = 0 && time = 0
x = 8
pausemovetime = 1
persistent = 0

[State 932, アニメ変更]
type = ChangeAnim
trigger1 = time = 0
value = 931
elem = 3
ignorehitpause = 1
pausemovetime = 10

[State 932, アニメ変更]
type = ChangeAnim
trigger1 = numtarget > 0 && time = 0
value = 930
elem = 3
ignorehitpause = 1
pausemovetime = 10

[State 932]
type = nothitby
trigger1 = animelemno(0) < 6
value = SCA
ignorehitpause = 1
pausemovetime = 10

[State 932]
type = PlayerPush
trigger1 = animelemno(0) < 6
value = 0

[State 932]
type = PosAdd
trigger1 = animelemno(0) = 4
x = 12

[State 932]
type = PosAdd
trigger1 = animelemno(0) = 5
x = 8
ignorehitpause = 1
persistent = 0

[State 932, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(5) <= 0
trigger1 = movecontact
value = 930
elem = 5
ignorehitpause = 1
persistent = 0

[State 932, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = time = 0
attr = S, SA
guardflag = M
hitflag = MAFD
damage = ceil(55*FVar(0))
priority = 4, Hit
pausetime = 10, 10
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 5
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .53
ground.velocity = -12
airguard.velocity = -1.6,-2.8
air.velocity = 7.6*var(15)-12,ifelse(var(15),fvar(10),0)
down.velocity = -12
ground.cornerpush.veloff = 0
p2stateno = 235
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(120*fvar(11)*(var(21)=0)), ceil(100*fvar(11)*(var(21)=0))
givepower = ceil(40*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 932]
type = VarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(7) = 10
ignorehitpause=1

[State 932]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .45
fvar(5) = .45
ignorehitpause=1

[State 932, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
[Statedef 940]
type     = S
movetype = I
physics  = N
ctrl     = 0
anim     = 952
sprpriority = 3

[State 940]
Type = AssertSpecial
Trigger1 = 1
Flag = Noshadow
IgnoreHitPause = 1

[State 940]
type = VarRandom
trigger1 = Time =0
v = 0
range = 360

[State 940]
type = AngleDraw
trigger1 = 1
value = Var(0)

[State 940]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 940]
type = DestroySelf
trigger1 = animtime = 0

[Statedef 941]
type     = S
movetype = I
physics  = N
ctrl     = 0
anim     = 953
sprpriority = 3

[State 941]
Type = AssertSpecial
Trigger1 = 1
Flag = Noshadow
IgnoreHitPause = 1

[State 941]
type = VarRandom
trigger1 = Time =0
v = 0
range = 360

[State 941]
type = AngleDraw
trigger1 = 1
value = Var(0)

[State 941]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 941]
type = DestroySelf
trigger1 = animtime = 0

;===========================================================================
; 必殺技
;===========================================================================
;電撃波弱
[Statedef 1000]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1000
ctrl = 0
sprpriority = 2
facep2 = 1

[State 1000, アニメ変更]
type = ChangeAnim
trigger1 = AnimElemTime(5) <= 0
trigger1 = movecontact
value = 1000
elem = 5
ignorehitpause = 1
persistent = 0

[State 1000, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem = 4
attr = S, SA
guardflag = MA
hitflag = MAFD
animtype = medium
damage = ceil(80*FVar(0)*fvar(12))
priority = 1, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
ground.slidetime = 19
ground.hittime  = 19
guard.hittime  = 16
yaccel = .53
ground.velocity = -3
airguard.velocity = -2.4,-.8
air.velocity = -1.5*var(15)-3,ifelse(var(15),fvar(10),-6.5)
down.velocity = -4.5,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 20
getpower = ceil(80*fvar(11)*(var(21)=0)), ceil(70*fvar(11)*(var(21)=0))
givepower = ceil(28*fvar(11)), ceil(14*fvar(11))
id = StateNo

[State 1000]
type = Helper
trigger1 = animelem = 4
ignorehitpause=1
name = "ef"
stateno = 1001
pos = 15, -20
postype = p1
ownpal = 1
ID = 1001
ignorehitpause=1

[State 1000, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 5

[State 1000, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 1001]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1001
anim = 1
ctrl = 0
sprpriority = 4

[State 1001, エフェクト]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1001]
type = Trans
trigger1 = 1
trans = addalpha
alpha =  256, 256

[State 1001]
type = AngleDraw
trigger1 = animelemno(0) < 3
scale = 0.75, 0.75
ignorehitpause=1

[State 1001]
type = AngleDraw
trigger1 = animelemno(0) > 3
scale = 0.75, 0.5
ignorehitpause=1

[State 1001, エフェクト]
type = DestroySelf
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;電撃波中
[Statedef 1010]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1010
ctrl = 0
sprpriority = 2
facep2 = 1

[State 1010, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem = 4
attr = S, SA
guardflag = M
hitflag = MAFD
animtype = medium
damage = ceil(70*FVar(0)*fvar(12)),6
priority = 1, Hit
pausetime = 4,4
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
yaccel = .53
ground.velocity = -3,-6.5
airguard.velocity = -2.4,-.8
air.velocity = -1.5*var(15)-3,ifelse(var(15),fvar(10),-6.5)
down.velocity = -4.5,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(50*fvar(11)*(var(21)=0)), ceil(40*fvar(11)*(var(21)=0))
givepower = ceil(16*fvar(11)), ceil(8*fvar(11))
id = StateNo

[State 1010, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelem = 5 || animelem = 6
attr = S, SP
guardflag = M
hitflag = MAFD
animtype = medium
damage = ceil(70*FVar(0)*fvar(12)),3
priority = 1, Hit
pausetime = 4,4
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
guard.hittime  = 15
guard.dist = 240
yaccel = .53
ground.velocity = -3
airguard.velocity = -2.4,-.8
air.velocity = -1.5*var(15)-3,ifelse(var(15),fvar(10),-6.5)
down.velocity = -4.5,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(50*fvar(11)*(var(21)=0)), ceil(40*fvar(11)*(var(21)=0))
givepower = ceil(16*fvar(11)), ceil(8*fvar(11))
id = StateNo

[State 1010]
type = Helper
trigger1 = animelem = 4
ignorehitpause=1
name = "ef"
stateno = 1011
pos = 15, -20
postype = p1
ownpal = 1
ID = 1011
ignorehitpause=1

[State 1010, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 4
value = 0, 5

[State 1010, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 1011]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 1011
anim = 1
ctrl = 0
sprpriority = 4

[State 1001, エフェクト]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 1001]
type = Trans
trigger1 = 1
trans = addalpha
alpha =  256, 256

[State 1011]
type = AngleDraw
trigger1 = animelemno(0) < 3
scale = 0.75, 0.75
ignorehitpause=1

[State 1011]
type = AngleDraw
trigger1 = animelemno(0) = 3
scale = 0.875, 0.625
ignorehitpause=1

[State 1011]
type = AngleDraw
trigger1 = animelemno(0) > 3
scale = 1, 0.5
ignorehitpause=1

[State 1001, エフェクト]
type = DestroySelf
trigger1 = animtime = 0

;---------------------------------------------------------------------------
;ブラシ投げ弱
[Statedef 1100]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1100
ctrl = 0
sprpriority = 2

[State 1100]
type = posadd
trigger1 = AnimElemTime(3) = 0 || AnimElemTime(4) = 0 || AnimElemTime(5) = 0
x = 2

[State 1100]
type = posadd
trigger1 = AnimElemTime(6) = 0 || AnimElemTime(7) = 0 || AnimElemTime(8) = 0 || AnimElemTime(10) = 0 || AnimElemTime(12) = 0
x = 6

[State 1100, エフェクト]
type = Explod
trigger1 = animelemno(0) = 1 && time < 20
anim = 1101
pos = -7,-12
postype = p1
removetime = 1
ID = 1101
sprpriority = 3
ownpal = 1

[State 1100, エフェクト]
type = Explod
trigger1 = animelemno(0) = 2
anim = 1102
pos = -11,-25
postype = p1
removetime = 1
ID = 1102
sprpriority = 3
ownpal = 1

[State 1100, エフェクト]
type = Explod
trigger1 = animelemno(0) = 3
anim = 1103
pos = -5,-26
postype = p1
removetime = 1
ID = 1103
sprpriority = 3
ownpal = 1

[State 1100, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 4
value = 0, 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S1100,0
channel = 0

[State 1100]
type = Helper
trigger1 = AnimElem = 4
name = "mop"
stateno = 1104
pos = 40,-30
ownpal = 1
ID = 1104

[State 1100]
type = StateTypeSet
trigger1 = AnimElemTime(8) = 0 
movetype= I

[State 1100, ステート変更]
type = ChangeState
trigger1 = animtime= 0
value = 0
ctrl = 1

[Statedef 1104]
type    = S
movetype= A
physics = N
velset = 15, -3
anim = 1104
ctrl = 0
sprpriority = 4

[State 1104]
type = NotHitBy
trigger1 = 1
value = ,AT
time = 1

[State 1104]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 1105
time = 1

[State 1104]
type = HitOverride
trigger1 = 1
attr = SCA,AT
slot = 1

[State 1104]
type = velset
trigger1 = 1
x = vel x*.975
y = vel y*.975

[State 1104]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1104, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = S, SP
guardflag = MA
hitflag = MAFD
damage = ceil(55*parent,FVar(0))
priority = 4, Hit
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
guard.hittime  = 10
yaccel = .53
ground.velocity = -3.6
airguard.velocity = -2.2,-.8
air.velocity = -1.2*parent,var(15)-3.6,ifelse(parent,var(15),parent,fvar(10),-5.5)
down.velocity = -5.2,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 18
getpower = ceil(75*parent,fvar(11)*(parent,var(21)=0)), ceil(60*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(25*parent,fvar(11)), ceil(13*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1104, ヘルパーを消す]
type = changestate
trigger1 = movecontact
value = 1105

[State 1104, ヘルパーを消す]
type = DestroySelf
trigger1 = screenpos X != [-20,340]

[Statedef 1105]
type    = S
movetype= A
physics = N
velset = 0,0
anim = 1105
ctrl = 0
sprpriority = 4
movehitpersist = 1

[State 1105]
type = Helper
trigger1 = time = 0
trigger1 = movehit
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = 15-Random%30, 15-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 1105, 速度]
type = VelSet
trigger1 = time = 6
x = 1
y = -6

[State 1105, 速度]
type = Gravity
trigger1 = time > 5

[State 1105, ヘルパーを消す]
type = DestroySelf
trigger1 = pos Y > 0

;---------------------------------------------------------------------------
;ブラシ投げ中
[Statedef 1110]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1110
ctrl = 0
sprpriority = 2

[State 1110]
type = posadd
trigger1 = AnimElemTime(3) = 0 || AnimElemTime(4) = 0 || AnimElemTime(5) = 0
x = 2

[State 1110]
type = posadd
trigger1 = AnimElemTime(6) = 0 || AnimElemTime(7) = 0 || AnimElemTime(8) = 0 ||  AnimElemTime(10) = 0 || AnimElemTime(12) = 0
x = 6

[State 1110, エフェクト]
type = Explod
trigger1 = animelemno(0) = 1 && time < 20
anim = 1101
pos = -7,-12
postype = p1
removetime = 1
ID = 1101
sprpriority = 3
ownpal = 1

[State 1110, エフェクト]
type = Explod
trigger1 = animelemno(0) = 2
anim = 1102
pos = -11,-25
postype = p1
removetime = 1
ID = 1102
sprpriority = 3
ownpal = 1

[State 1110, エフェクト]
type = Explod
trigger1 = animelemno(0) = 3
anim = 1103
pos = -5,-26
postype = p1
removetime = 1
ID = 1103
sprpriority = 3
ownpal = 1

[State 1110, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElem = 4
value = 0, 3

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 1
value = S1100,0
channel = 0

[State 1110]
type = Helper
trigger1 = AnimElem = 4
name = "mop"
stateno = 1114
pos = 32,-40
ownpal = 1
ID = 1114

[State 1110]
type = StateTypeSet
trigger1 = AnimElemTime(8) = 0 
movetype= I

[State 1110, ステート変更]
type = ChangeState
trigger1 = animtime= 0
value = 0
ctrl = 1

[Statedef 1114]
type    = S
movetype= A
physics = N
velset = 12, -12
anim = 1114
ctrl = 0
sprpriority = 4

[State 1114]
type = NotHitBy
trigger1 = 1
value = ,AT
time = 1

[State 1114]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 1105
time = 1

[State 1114]
type = HitOverride
trigger1 = 1
attr = SCA,AT
slot = 1

[State 1114]
type = velset
trigger1 = 1
x = vel x*.975
y = vel y*.975

[State 1114]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1114, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = S, SP
guardflag = HA
hitflag = MAFD
damage = ceil(55*parent,FVar(0)),8
priority = 4, Hit
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
guard.hittime  = 10
yaccel = .53
ground.velocity = -3.6
airguard.velocity = -3.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(75*parent,fvar(11)*(parent,var(21)=0)), ceil(60*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(25*parent,fvar(11)), ceil(13*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1114, ヘルパーを消す]
type = changestate
trigger1 = movecontact
value = 1105

[State 1114, ヘルパーを消す]
type = DestroySelf
trigger1 = screenpos X != [-20,340]

;---------------------------------------------------------------------------
;地上電磁跳躍B
[Statedef 1200]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 1200
ctrl = 0
sprpriority = 2
facep2 = 1

[State 1200]
type = playerpush
trigger1 = 1
value = 0

[State 1200]
type = VarSet
trigger1 = Time = 0
var(2) = 0

[State 1200]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 1200]
type = Helper
trigger1 = animelem = 2
name = "spark"
stateno = 1207
pos = 5-backedgedist, -170
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1200, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 5
value = 0, 5

[State 1200, ステート変更]
type = StateTypeSet
trigger1 = animelemtime(3) = 0
statetype = A
movetype = I
physics = A

[State 1200, ステート変更]
type = ChangeState
trigger1 = time > 24
trigger1 = backedgedist < 10
value = 1210
ctrl = 1

[State 1200, ステート変更]
type = velset
trigger1 = animelemtime(3) >= 0
x = ifelse(facing = 1,-ScreenPos X/ifelse(time<24,24-time,1),(ScreenPos X-320)/ifelse(time<24,24-time,1))

[State 1200, ステート変更]
type = velset
trigger1 = animelemtime(3) = 0
y = -12

[State 1200]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = -7, -30
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;地上電磁跳躍A
[Statedef 1201]
type    = S
movetype= I
physics = S
velset = 0,0
anim = 1201
ctrl = 0
sprpriority = 2
facep2 = 1

[State 1201]
type = VarSet
trigger1 = Time = 0
var(2) = 0

[State 1201]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 1201]
type = Helper
trigger1 = animelem = 2
name = "spark"
stateno = 1207
pos = 30, -155
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1201, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 5
value = 0, 5

[State 1201, ステート変更]
type = StateTypeSet
trigger1 = animelemtime(3) = 0
statetype = A
movetype = I
physics = A

[State 1201, ステート変更]
type = velset
trigger1 = animelemtime(3) = 0
x = const(velocity.jump.fwd.x)/2
y = const(velocity.jump.y)

[State 1201, ステート変更]
type = veladd
trigger1 = animelemtime(3) >= 0
y = -.2

[State 1201, ステート変更]
type = CtrlSet
trigger1 = time > 24
value = 1

[State 1201]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = 2, -29
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;---------------------------------------------------------------------------
;空中電磁跳躍B
[Statedef 1203]
type    = A
movetype= I
physics = A
anim = 1200
ctrl = 0
velset = 0,0
sprpriority = 2
facep2 = 1

[State 1203]
type = playerpush
trigger1 = 1
value = 0

[State 1203]
type = VarSet
trigger1 = Time = 0
var(2) = 0

[State 1203]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 1203]
type = Helper
trigger1 = animelem = 2
name = "spark"
stateno = 1207
pos = 5-backedgedist, -30
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1203, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 5
value = 0, 5

[State 1203, ステート変更]
type = ChangeState
trigger1 = backedgedist < 10
value = 1210
ctrl = 1

[State 1203, ステート変更]
type = velset
trigger1 = animelemtime(3) = 0
x = -10
y = -3

[State 1203, ステート変更]
type = veladd
trigger1 = animelemtime(3) >= 0 && animelemtime(8) < 0
y = -.2

[State 1203]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = 2, -29
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;空中電磁跳躍A
[Statedef 1204]
type    = A
movetype= I
physics = A
anim = 1201
ctrl = 0
velset = 0,0
sprpriority = 2
facep2 = 1

[State 1204]
type = VarSet
trigger1 = Time = 0
var(2) = 0

[State 1204]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 1204]
type = Helper
trigger1 = animelem = 2
name = "spark"
stateno = 1207
pos = ceil(P2Dist X*.3), -130
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1204, 音を鳴らす]
type = PlaySnd
trigger1 = animelem = 3 || animelem = 5
value = 0, 5

[State 1204, ステート変更]
type = velset
trigger1 = animelemtime(3) = 0
x = const(velocity.jump.fwd.x)/2
y = const(velocity.airjump.y)

[State 1204, ステート変更]
type = veladd
trigger1 = animelemtime(3) >= 0
y = -.2

[State 1204, ステート変更]
type = CtrlSet
trigger1 = time > 20
value = 1

[State 1204]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = 2, -29
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;---------------------------------------------------------------------------
;F着地
[Statedef 1206]
statetype = S
movetype = A
physics = S
anim = 1206
ctrl = 0
sprpriority = 2
facep2 = 1

[State 1206, ステート変更]
type = posset
trigger1 = time = 0
y = 0

[State 1206, ステート変更]
type = velset
trigger1 = time = 0
y = 0

[State 1206, ステート変更]
type = velmul
trigger1 = Vel X != 0
x = 1.05

[State 1206, ステート変更]
type = changeanim
trigger1 = Vel X != 0 && animelemno(0) = 2
value = 1206
elem = 2

[State 1206, ステート変更]
type = changestate
trigger1 = animtime = 0
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;電磁跳躍電撃
[Statedef 1207]
type    = S
movetype= I
physics = N
ctrl = 0
anim = 1207
sprpriority = 3

[State 1207]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 1207]
type = VarSet
trigger1 = (Parent,ScreenPos X-ScreenPos X)
fvar(0) = atan((ScreenPos Y-Parent,ScreenPos Y+30)/(Parent,ScreenPos X-ScreenPos X))*180/pi

[State 1207]
type = VarAdd
trigger1 = Parent,ScreenPos X-ScreenPos X<0
fvar(0) = 180

[State 1207]
type = VarAdd
trigger1 = facing = -1
fvar(0) = 180

[State 1207]
type = AngleDraw
trigger1 = 1
value = fvar(0)*facing
scale = (abs(Parent,ScreenPos X-ScreenPos X)**2+abs(ScreenPos Y-Parent,ScreenPos Y+30)**2)**.5/145,.25 

[State 1207]
type = DestroySelf
trigger1 = time >= 24
trigger2 = parent,movetype = H
ignorehitpause=1

;電磁跳躍電撃F
[Statedef 1208]
type    = S
movetype= I
physics = N
ctrl = 0
anim = 1207
sprpriority = 3

[State 1208]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256, 256

[State 1208]
type = VarSet
trigger1 = 1
fvar(0) = atan((ScreenPos Y-Parent,ScreenPos Y)/(Parent,ScreenPos X-ScreenPos X))*180/pi

[State 1208]
type = VarAdd
trigger1 = Parent,ScreenPos X-ScreenPos X<0
fvar(0) = 180

[State 1208]
type = VarAdd
trigger1 = facing = -1
fvar(0) = 180

[State 1208]
type = AngleDraw
trigger1 = 1
value = fvar(0)*facing
scale = (abs(Parent,ScreenPos X-ScreenPos X)**2+abs(ScreenPos Y-Parent,ScreenPos Y)**2)**.5/145,.25 

[State 1208]
type = DestroySelf
trigger1 = time >= 24
trigger2 = parent,movetype = H
ignorehitpause=1

;---------------------------------------------------------------------------
;壁張り付き
[Statedef 1210]
type    = A
movetype= A
physics = A
poweradd= 0
anim = 1210
ctrl = 0
sprpriority = 2

[State 1210]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 1210]
type = playerpush
trigger1 = 1
value = 0

[State 1210]
type = turn
trigger1 = facing*Pos X > 0

[State 1210]
type = VarSet
trigger1 = Time = 5
var(8) = 2

[State 1210]
type = velset
trigger1 = time < 40
x = -320
y = 0

[State 1210]
type = velset
trigger1 = time = 40
x = 0
y = 0

[State 1210, ステート変更]
type = ChangeState
trigger1 = time >= 40
value = 50
ctrl = 1

;壁張り付き電磁跳躍A
[Statedef 1211]
type    = A
movetype= I
physics = A
anim = 1201
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1211]
type = Helper
trigger1 = Time = 0
name = "spark"
stateno = 1207
pos = 120, -100
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1211, ステート変更]
type = changeanim
trigger1 = Time = 0
value = 1201
elem = 3

[State 1211, 音を鳴らす]
type = PlaySnd
trigger1 = animelem =4 || animelem = 6
value = 0, 5

[State 1211, ステート変更]
type = velset
trigger1 = animelemtime(3) = 0
x = 4
y = const(velocity.airjump.y)*.75

[State 1211, ステート変更]
type = veladd
trigger1 = animelemno(0) = [3,8]
y = -.2

[State 1211, ステート変更]
type = CtrlSet
trigger1 = time > 20
value = 1

[State 1211]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = 0, -20
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;壁張り付き対岸跳躍
[Statedef 1212]
type    = A
movetype= I
physics = A
anim = 1201
ctrl = 0
velset = 0,0
sprpriority = 2

[State 1212]
type = playerpush
trigger1 = 1
value = 0

[State 1212]
type = Helper
trigger1 = Time = 0
name = "spark"
stateno = 1207
pos = 300, 0
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 1212, ステート変更]
type = changeanim
trigger1 = Time = 0
value = 1201
elem = 3

[State 1212, 音を鳴らす]
type = PlaySnd
trigger1 = animelem =4 || animelem = 6
value = 0, 5

[State 1212, ステート変更]
type = ChangeState
trigger1 = frontedgedist < 10
value = 1210
ctrl = 1

[State 1212]
type = velset
trigger1 = animelemtime(3) = 0
x = 12
y = -1

[State 1212, ステート変更]
type = veladd
trigger1 = animelemtime(3) >= 0
y = -const(movement.yaccel)*0.7

[State 1212]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0
anim = 2800+random%6
pos = 0, -20
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;---------------------------------------------------------------------------
;壁張り付き電撃
[Statedef 1220]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 1220
sprpriority = 2

[State 1220]
type = playerpush
trigger1 = 1
value = 0

[State 1220, ステート変更]
type = velset
trigger1 = 1
x = -320
y = 0

[State 1220]
type = changeanim
triggerall = animelemno(0) = 2
triggerall = time = [13,25]
Trigger1 = var(59) <= 0
trigger1 = command != "hold_a" && command != "hold_b" && command != "hold_c"
;AI用記述
Trigger2 = var(59) != 0
Trigger2 = var(55) = 0
value = 1220
elem = 3

[State 1220, BEエフェクト]
type = Helper
trigger1 = time = 26 && animelemno(0) = 2
ignorehitpause=1
name = "BEef"
stateno = 6225
pos = -0, -12
postype = p1
ownpal = 1
ID = 6225

[State 1220]
type = Helper
trigger1 = AnimElemTime(3) = 0 && time < 26
name = "spark"
stateno = 1221
pos = 10,9
ownpal = 1
ID = 1221

[State 1220]
type = Helper
trigger1 = AnimElemTime(3) = 0 && time > 26
name = "spark"
stateno = 1222
pos = 10,9
ownpal = 1
ID = 1221

[State 1220, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0 
value = 0, 5

[State 1220, ステート変更]
type = velset
trigger1 = animtime = 0
x = 0
y = 0

[State 1220]
type = changestate
trigger1 = animtime = 0
value = 50

[Statedef 1221]
type    = A
movetype= A
physics = N
velset = 8,12
anim = 1221
ctrl = 0
sprpriority = 4

[State 1221]
type = Explod
trigger1 = time = 0
anim = 1223+random%2
ID = 1223
pos = 0, 0
postype = p1
scale =.5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1221]
type = Explod
trigger1 = time%2 && pos Y < -40
anim = 1223+random%5
ID = 1223
pos = 0, 0
postype = p1
scale =.5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1221, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = A, SP
guardflag = MA
hitflag = MAFD
damage = ceil(75*parent,FVar(0)*parent,fvar(12))
priority = 4, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 20
yaccel = .48
ground.velocity = -4.6
airguard.velocity = -2.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 17
getpower = ceil(120*parent,fvar(11)*(parent,var(21)=0)), ceil(102*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause=1

[State 1221]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1221]
type = Helper
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = 15-Random%30, 15-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 1221]
type = posadd
trigger1 = pos Y >-40
x = -pos Y*.5

[State 1221]
type = posset
trigger1 = pos Y >-40
y = 0

[State 1221]
type = velset
trigger1 = pos Y >-40
x = 0
y = 0

[State 1221]
type = Explod
trigger1 = pos Y = 0
anim = 1228
ID = 1228
pos = 0, 0
postype = p1
scale = .5, .25
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1221, ヘルパーを消す]
type = DestroySelf
trigger1 = pos Y = 0

;---------------------------------------------------------------------------
[Statedef 1222]
type    = A
movetype= A
physics = N
velset = 8,12
anim = 1221
ctrl = 0
sprpriority = 4

[State 1222]
type = Explod
trigger1 = time = 0
anim = 1223+random%2
ID = 1223
pos = 0, 0
postype = p1
scale =.5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1222]
type = Explod
trigger1 = time%2 && pos Y < -40
anim = 1223+random%5
ID = 1223
pos = 0, 0
postype = p1
scale =.5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1222]
type = posadd
trigger1 = pos Y >-40
x = -pos Y*.5
persistent = 0

[State 1222]
type = posset
trigger1 = pos Y >-40
y = 0
persistent = 0

[State 1222]
type = velset
trigger1 = pos Y >-40
x = 0
y = 0
persistent = 0

[State 1222, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = A, SP
guardflag = MA
hitflag = MAFD
damage = ceil(75*parent,FVar(0)*parent,fvar(12)),5
priority = 4, Hit
pausetime = 0, 0
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 20
yaccel = .48
ground.velocity = -4.6
airguard.velocity = -2.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 17
getpower = ceil(120*parent,fvar(11)*(parent,var(21)=0)), ceil(102*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = StateNo

[State 1222, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = pos Y = 0 && anim =1221
trigger2 = animtime = 0 && anim =1230
attr = A, SP
guardflag = MA
hitflag = MAFD
damage = ceil(75*parent,FVar(0)*parent,fvar(12)),5
priority = 4, Hit
pausetime = 0, 0
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = low
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 20
yaccel = .48
ground.velocity = -4.6
airguard.velocity = -2.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 17
getpower = ceil(40*parent,fvar(11)*(parent,var(21)=0)), ceil(34*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(14*parent,fvar(11)), ceil(7*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause=1

[State 1222]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1222]
type = Helper
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = 15-Random%30, 15-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 1222]
type = Explod
trigger1 = anim = 1230
trigger1 = animelemtime(2) = 0 || animelemtime(4) = 0
anim = 1231+random%3
ID = 1231
pos = 0, 0
postype = p1
facing = 3-animelemno(0)
scale = .5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1222]
type = Explod
trigger1 = animelemtime(3) = 0 && anim =1230
anim = 1234+random%3
ID = 1234
pos = 0, 0
postype = p1
facing = 1-random%2*2
scale = .5, .5
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1222]
type = posadd
trigger1 = anim =1230
trigger1 = animelemtime(2) = 0 || animtime = 0
x = 25

[State 1222]
type = Explod
trigger1 = pos Y = 0 && anim =1221
trigger2 = animtime = 0 && anim =1230
anim = 1228
ID = 1228
pos = 0, 0
postype = p1
scale = .5, .25
sprpriority = 4
ownpal = 1
removeongethit = 1
ignorehitpause=1

[State 1222]
type = changeanim
trigger1 = pos Y = 0 && anim =1221
trigger2 = animtime = 0 && anim =1230
value = 1230

[State 1222, ヘルパーを消す]
type = DestroySelf
trigger1 = pos X != [-360,360]

;---------------------------------------------------------------------------
;磁性操作霰
[Statedef 1300]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 1300
sprpriority = 2

[State 1300]
type = changeanim
triggerall = animelemno(0) = 2
trigger1 = time = 6
value = 1300
elem = 3

[State 1300]
type = Helper
trigger1 = AnimElemTime(2) = 0
name = "can"
stateno = 1301
pos = -15,-25
ownpal = 1
ID = 1301

[State 1300]
type = StateTypeSet
trigger1 = AnimElemTime(5) = 0 
movetype= I

[State 1300, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(4) = 0 
value = 0, 5

[Statedef 1301]
type    = A
movetype= A
physics = N
velset = 0,-6
anim = 1301+random%4
ctrl = 0
sprpriority = 4

[State 1301]
type = NotHitBy
trigger1 = 1
value = ,AT
time = 1

[State 1301]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 1306

[State 1301]
type = HitOverride
trigger1 = 1
attr = SCA,AT
slot = 1

[State 1301]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1301]
type = varset
trigger1 = time = 0
var(0) = parent,time-3

[State 1301]
type = explod
trigger1 = time < 3
anim = 2800+random%6
pos = 0, -10
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

[State 1301]
type = changestate
trigger1 = parent,anim = 1300
trigger1 = parent,animelemno(0) >= 4
value = parent,stateno+5

[State 1301]
type = veladd
trigger1 = pos Y < 0
y = const(movement.yaccel)*.8

[State 1301]
type = changestate
trigger1 = pos Y >= 0
value = 1306

[Statedef 1305]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 4

[State 1305]
type = NotHitBy
trigger1 = 1
value = ,AT
time = 1

[State 1305]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 1306

[State 1305]
type = HitOverride
trigger1 = 1
attr = SCA,AT
slot = 1

[State 1305]
type = varadd
trigger1 = time = 0
var(0) = 2

[State 1305]
type = varadd
trigger1 = var(0)
var(0) = -1

[State 1305]
type = velset
trigger1 = var(0) = 0
trigger1 = time > 8 && pos Y < -32
x = 8
y = 8

[State 1305]
type = changeanim
trigger1 = var(0) = 0
trigger1 = time > 8 && pos Y < -32
value = anim+4
persistent = 0

[State 1305]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1305, ヘルパーを消す]
type = veladd
trigger1 = pos Y < 0 && var(0) !=0
y = const(movement.yaccel)*.8

[State 1305, ヘルパーを消す]
type = velset
trigger1 = pos Y >= 0
x = -vel X

[State 1305, ヘルパーを消す]
type = changestate
trigger1 = pos Y >= 0
value = 1306

[State 1305]
type = explod
trigger1 = var(0) = 0
anim = 2800+random%6
pos = 0, -10
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1
persistent = 2

[State 1305, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = 1
attr = A, SP
guardflag = MA
hitflag = MAFD
damage = ceil(55*parent,FVar(0)*parent,fvar(12))
priority = 4, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
guard.hittime  = 10
yaccel = .53
ground.velocity = -3.6
airguard.velocity = -3.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 17
getpower = ceil(80*parent,fvar(11)*(parent,var(21)=0)), ceil(68*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(27*parent,fvar(11)), ceil(14*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause=1

[State 1305]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1305, ヘルパーを消す]
type = velset
trigger1 = movecontact
x = 2

[State 1305, ヘルパーを消す]
type = changestate
trigger1 = movecontact
value = 1306

[State 1305, ヘルパーを消す]
type = DestroySelf
trigger1 = screenpos X != [-20,340]

[Statedef 1306]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 4
movehitpersist = 1

[State 1306]
type = Helper
trigger1 = time = 0
trigger1 = MoveHit
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = 15-Random%30, 15-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 1306]
type = changeanim
trigger1 = time = 0 && anim = [1305,1308]
value = anim-4

[State 1306]
type = NotHitBy
trigger1 = 1
value = SCA
time = 1

[State 1306]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1306]
type = velset
trigger1 = time = 0
x = -vel X*.25

[State 1306]
type = velset
trigger1 = time = 0 && prevstateno = 5025
x = -2

[State 1306]
type = velset
trigger1 = time = 0
y = -4

[State 1306]
type = veladd
trigger1 = pos Y < 0
y = .4

[State 1306]
type = posset
trigger1 = pos Y >= 0
y = -0.5
persistent = 0

[State 1306, ヘルパーを消す]
type = DestroySelf
trigger1 = pos Y >= 0

;---------------------------------------------------------------------------
;磁性操作雹
[Statedef 1310]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 1300
sprpriority = 2

[State 1310]
type = velset
trigger1 = Time = [3,7]
x = 0
y = 0

[State 1310]
type = velset
trigger1 = Time = 8
x = -1.5
y = -7

[State 1310]
type = changeanim
triggerall = animelemno(0) = 2
triggerall = time = [8,18]
Trigger1 = var(59) <= 0
trigger1 = command != "hold_b" && command != "hold_c"
;AI用記述
Trigger2 = var(59) != 0
Trigger2 = var(55) = 0
value = 1300
elem = 3

[State 1310]
type = Helper
trigger1 = time < 30
trigger1 = time%11 = 7 && animelemno(0) = 2
name = "can"
stateno = 1301
pos = -15,-25
ownpal = 1
ID = 1301

[State 1310, BEエフェクト]
type = Helper
trigger1 = time = 24 && animelemno(0) = 2
ignorehitpause=1
name = "BEef"
stateno = 6225
pos = -13, -20
postype = p1
ownpal = 1
ID = 6225

[State 1310]
type = StateTypeSet
trigger1 = AnimElemTime(5) = 0
movetype= I

[State 1310]
type = CtrlSet
trigger1 = AnimElemTime(5) >= 0
trigger1 = Vel Y >= 6
value = 1

[State 1310, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0 
value = 0, 5

[Statedef 1315]
type    = A
movetype= A
physics = N
ctrl = 0
sprpriority = 4

[State 1315]
type = NotHitBy
trigger1 = 1
value = ,AT
time = 1

[State 1315]
type = HitOverride
trigger1 = 1
attr = SCA,AA,AP
stateno = 1306

[State 1315]
type = HitOverride
trigger1 = 1
attr = SCA,AT
slot = 1

[State 1315]
type = varadd
trigger1 = var(0)
var(0) = -1

[State 1315]
type = velset
trigger1 = var(0) = 0
trigger1 = time > 8 && pos Y < -32
x = 8
y = 8

[State 1315]
type = changeanim
trigger1 = var(0) = 0
trigger1 = time > 8 && pos Y < -32
value = anim+4
persistent = 0

[State 1315]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 1315]
type = veladd
trigger1 = pos Y < 0 && var(0) !=0
y = const(movement.yaccel)*.8

[State 1315]
type = velset
trigger1 = pos Y >= 0
x = -vel X

[State 1315]
type = changestate
trigger1 = pos Y >= 0
value = 1306

[State 1315]
type = explod
trigger1 = var(0) = 0
anim = 2800+random%6
pos = 0, 0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1
persistent = 2

[State 1315, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = 1
attr = A, SP
guardflag = MA
hitflag = MAFD
damage = ceil(55*parent,FVar(0)*parent,fvar(12))
priority = 4, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 16
ground.hittime  = 16
guard.hittime  = 10
yaccel = .53
ground.velocity = -3.6
airguard.velocity = -3.6,-.8
air.velocity = -2.6*parent,var(15)-2.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recovertime = 17
getpower = ceil(80*parent,fvar(11)*(parent,var(21)=0)), ceil(68*parent,fvar(11)*(parent,var(21)=0))
givepower = ceil(27*parent,fvar(11)), ceil(14*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause=1

[State 1315]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 1315, ヘルパーを消す]
type = velset
trigger1 = movecontact
x = 2

[State 1315, ヘルパーを消す]
type = changestate
trigger1 = movecontact
value = 1306

[State 1315, ヘルパーを消す]
type = DestroySelf
trigger1 = screenpos X != [-20,340]

;---------------------------------------------------------------------------
;跳電
[Statedef 1400]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1400
ctrl = 0
sprpriority = 2

[State 1400, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 5

[State 1400, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(3) = 0
value = 0, 9

[State 1400]
type = explod
trigger1 = animelemno(-1) = [1,4]
anim = 2806+random%6
pos = 0, -20
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,20
scale = .5,.5
ID = 2806
sprpriority = 3
ownpal = 1
removeongethit = 1
persistent = 6

[State 1400, エフェクト]
type = Helper
trigger1 = animelemtime(3) = 0
name = "spark"
stateno = 1401
pos = 7, 0
postype = p1
ownpal = 1
ID = 1401

[State 1400, ヒット定義]
type = HitDef
trigger1 = animelemno(0) = 3
trigger1 = movecontact = 0 && movereversed = 0
attr = S, NA
guardflag = M
hitflag = MAFD
damage = ceil(80*FVar(0)*fvar(12))
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 7
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = -2.4,-6.5
airguard.velocity = -3.6,-.8
air.velocity =-2.4*var(15),ifelse(var(15),fvar(10),-7)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = (P2MoveType!=A)
fall.recovertime = 20
getpower = ceil(80*fvar(11)*(var(21)=0)), ceil(68*fvar(11)*(var(21)=0))
givepower = ceil(27*fvar(11)), ceil(14*fvar(11))
id = StateNo

[State 1400, ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[Statedef 1401]
type    = S
movetype= I
physics = N
anim = 1
ctrl = 0

[State 1401, エフェクト]
type = Explod
trigger1 = time = 0
anim = 1231+random%3
ID = 1231
pos = 0, -20
postype = p1
facing = -1
scale = 0.25, 0.5
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 2
anim = 1231+random%3
ID = 1231
pos = 0, -30
postype = p1
facing = -1
vfacing = -1
scale = 0.25, 0.5
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 3 || time = 5 || time = 7 || time = 9
anim = 1231+random%3
ID = 1231
pos = ifelse(time < 6,12,36),0
postype = p1
facing = time%4-2
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 3 || time = 5 || time = 7 || time = 9
anim = 1231+random%3
ID = 1231
pos = ifelse(time < 6,-12,-36),0
postype = p1
facing = 2-time%4
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 4 || time = 8
anim = 1234+random%3
ID = 1234
pos = time*6-12, 0
postype = p1
facing = 1-random%2*2
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 4 || time = 8
anim = 1234+random%3
ID = 1234
pos = 12-time*6, 0
postype = p1
facing = 1-random%2*2
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = Explod
trigger1 = time = 0
anim = 1228
ID = 1228
pos = 0, 0
postype = p1
facing = 1-random%2*2
scale = 0.3, 0.15
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = DestroySelf
trigger1 = time = 10

;---------------------------------------------------------------------------
;這電
[Statedef 1410]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 1410
ctrl = 0
sprpriority = 2

[State 1410, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 0, 5

[State 1410, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 0, 9

[State 1410]
type = explod
trigger1 = animelemno(0) = 4
anim = 2806+random%6
pos = 0, -20
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,20
scale = .5,.5
ID = 2806
sprpriority = 3
ownpal = 1
removeongethit = 1
persistent = 6

[State 1410, エフェクト]
type = Helper
trigger1 = animelemtime(5) = 0
name = "spark"
stateno = 1411
pos = 7, 0
postype = p1
ownpal = 1
ID = 1411

[State 1410, ヒット定義]
type = HitDef
trigger1 = animelemtime(5) = 0
attr = S, NA
guardflag = H
hitflag = MAFD
damage = ceil(80*FVar(0)*fvar(12)),8
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 7
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = -2.4,-6.5
airguard.velocity = -3.6,-.8
air.velocity =-2.4*var(15)-2.4,ifelse(var(15),fvar(10),-7.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(120*fvar(11)*(var(21)=0)), ceil(102*fvar(11)*(var(21)=0))
givepower = ceil(240*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 1410, ヒット定義]
type = HitDef
trigger1 = animelemtime(6) = 0
attr = S, NA
guardflag = L
hitflag = MFD
damage = ceil(80*FVar(0)*fvar(12)),8
priority = 4, Hit
pausetime = 6, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 7
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
guard.dist = 240
yaccel = .45
ground.velocity = -2.4,-6.5
airguard.velocity = -3.6,-.8
air.velocity =-2.4*var(15)-2.4,ifelse(var(15),fvar(10),-7.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = ceil(120*fvar(11)*(var(21)=0)), ceil(102*fvar(11)*(var(21)=0))
givepower = ceil(240*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 1410, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .65
fvar(5) = .65
ignorehitpause=1

[State 1410, ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[Statedef 1411]
type    = S
movetype= I
physics = N
anim = 1
ctrl = 0

[State 1411, エフェクト]
type = Explod
trigger1 = time = 0
anim = 1231+random%3
ID = 1231
pos = 0, -20
postype = p1
facing = -1
scale = 0.25, 0.5
sprpriority = 4
ownpal = 1

[State 1411, エフェクト]
type = Explod
trigger1 = time = 2
anim = 1231+random%3
ID = 1231
pos = 0, -30
postype = p1
facing = -1
vfacing = -1
scale = 0.25, 0.5
sprpriority = 4
ownpal = 1

[State 1411, エフェクト]
type = Explod
trigger1 = time > 2
anim = 1234+random%3
ID = 1234
pos = time*16-32, 12
postype = p1
facing = 1-random%2*2
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1411, エフェクト]
type = Explod
trigger1 = time > 2
anim = 1234+random%3
ID = 1234
pos = 32-time*16, 12
postype = p1
facing = 1-random%2*2
scale = 0.25, 0.25
sprpriority = 4
ownpal = 1

[State 1411, エフェクト]
type = Explod
trigger1 = time = 0
anim = 1228
ID = 1228
pos = 0, 0
postype = p1
facing = 1-random%2*2
scale = 0.3, 0.15
sprpriority = 4
ownpal = 1

[State 1401, エフェクト]
type = DestroySelf
trigger1 = time = 14

;===========================================================================
;EX-Edge
;===========================================================================
;雷撃波
[Statedef 2020]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2020
ctrl = 0
sprpriority = 2
facep2 = 1

[State 2020, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(2) = 0
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
movetime = 36
darken = 0
p2defmul = 1

[State 2020, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(2) = 0
ignorehitpause=1
stateno = 6500
pos = 12, -30
postype = p1
supermovetime = 36
ownpal = 1

[State 2020]
type = varset
trigger1 = AnimElemTime(2) = 0 && var(21) != 3
var(6) = 450
ignorehitpause=1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 0
anim = 1231+random%3
pos = 12,-37
postype = p1
scale = .3,.3
supermovetime = 36
ID = 1231
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 0
anim = 1231+random%3
pos = -12,-37
postype = p1
scale = .3,.3
facing = -1
supermovetime = 36
ID = 1231
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 1
anim = 1234+random%3
pos = 12,-37
postype = p1
scale = .3,.3
facing = 1-random%2*2
supermovetime = 36
ID = 1234
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 1
anim = 1234+random%3
pos = -12,-37
postype = p1
scale = .3,.3
facing = 1-random%2*2
supermovetime = 36
ID = 1234
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 2
anim = 1231+random%3
pos = 12,-37
postype = p1
scale = .3,.3
facing = -1
supermovetime = 36
ID = 1231
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = 2
anim = 1231+random%3
pos = -12,-37
postype = p1
scale = .3,.3
supermovetime = 36
ID = 1231
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = [3,5]
anim = 2021+random%3
pos = 24,-80+AnimElemTime(1)%6*15
postype = p1
scale = .3,.3
facing = 1-random%2*2
vfacing = 1-random%2*2
supermovetime = 36
ID = 2025
sprpriority = 3
ownpal = 1

[State 2020, エフェクト]
type = Explod
trigger1 = AnimElemTime(1) = [3,5]
anim = 2021+random%3
pos = -24,-80+AnimElemTime(1)%6*15
postype = p1
scale = .3,.3
facing = 1-random%2*2
vfacing = 1-random%2*2
supermovetime = 36
ID = 2025
sprpriority = 3
ownpal = 1

[State 2020]
type = explod
trigger1 = animelemtime(1) >= 0 && animelemtime(13) < 0
anim = 2800+random%6
pos = 0, -25
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 20,30
scale = .5,.5
supermovetime = 36
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1
persistent = 2

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 1
name = "spark"
stateno = 2024
pos = 15, -25
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 5
name = "spark"
stateno = 2024
pos = 12, -45
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 9
name = "spark"
stateno = 2024
pos = 9, -15
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 13
name = "spark"
stateno = 2024
pos = 12, -5
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 17
name = "spark"
stateno = 2024
pos = 9, -35
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020]
type = Helper
trigger1 = animelemtime(6) = 21
name = "spark"
stateno = 2024
pos = 15, -25
postype = p1
ownpal = 1
ID = 2024
ignorehitpause=1

[State 2020, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(6) >= 0 && animelemtime(13) < 0
value = 0, 5
persistent = 4

[State 2020, ステート変更]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1

[Statedef 2024]
type    = S
movetype= A
physics = N
velset = 50,0
anim = 2024
ctrl = 0
sprpriority = 4

[State 2024]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2024]
type = nothitby
trigger1 = 1
value = SCA

[State 2024, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 2025+random%2
pos = 0,0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
scale = 1,.5
ID = 2025
sprpriority = 3
ownpal = 1

[State 2024, エフェクト]
type = Explod
trigger1 = Time%2 = 0 && time != 0 && Pos X = [-160,160]
anim = 2025+random%5
pos = 0,0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 0,5
scale = 1,.5
ID = 2025
sprpriority = 3
ownpal = 1

[State 2024]
type = explod
trigger1 = time%2 && random%3 = 0
anim = 2030+random%2
ID = 2030+random%2
pos = 0, 0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 60,20
sprpriority = 4
ownpal = 1
ignorehitpause=1

[State 2024]
type = explod
trigger1 = time%2 = 0
anim = 2035
ID = 2035
pos = 0, 0
postype = p1
random = 80,20
scale = (time*gametime%10+10)*.01,(time*gametime%10+10)*.01
sprpriority = 4
ownpal = 1
ignorehitpause=1

[State 2024]
type = explod
trigger1 = time%2 = 0
anim = 2035
ID = 2035
pos = 0, 0
postype = p1
random = 80,20
scale = (time*gametime%10+10)*.01,(time*gametime%10+10)*.01
sprpriority = 4
ownpal = 1
ignorehitpause=1

[State 2024, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = movecontact = 0
trigger1 = movereversed = 0
attr = S, HA
guardflag = MA
hitflag = MAFD
animtype = medium
damage = ceil(95*parent,FVar(0)),4
priority = 1, Hit
pausetime = 0,3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
ground.hittime  = 18
yaccel = .53
ground.velocity = -7
airguard.velocity = -2.4,-.8
air.velocity = -1.5*parent,var(15)-3,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -4.5,-2.5
ground.cornerpush.veloff = 0
airfall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(10*parent,fvar(11)), ceil(5*parent,fvar(11))
id = StateNo

[State 2024, 補正]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = parent,fvar(5) > .5
fvar(5) = .5
ignorehitpause=1

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1
persistent = 0

[State 2024]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000
persistent = 0

[State 2024, ヘルパーを消す]
type = DestroySelf
trigger1 = parent,stateno != 2020 && Pos X != [-160,160]

;---------------------------------------------------------------------------
;磁性操作引
[Statedef 2120]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2120
ctrl = 0
sprpriority = 2

[State 2120]
type = explod
trigger1 = time%5 = 0 && animelemtime(3) = [0,24]
anim = 2800+random%6
pos = 19, -16
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
bindtime = 6
ID = 2800
scale = .25,.25
sprpriority = 5
supermovetime = 36
ownpal = 1

[State 2120, 音を鳴らす]
type = PlaySnd
trigger1 = time%5 = 0 && animelemtime(3) = [0,24]
value = 0, 5

[State 0, PlaySnd]
type = PlaySnd
trigger1 = animelem = 5
value = S1100,0
channel = 0

[State 2120, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(3) = 3
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
movetime = 36
darken = 0
p2defmul = 1

[State 2120, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(3) = 3
ignorehitpause=1
stateno = 6500
pos = 15, -16
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2120]
type = Helper
trigger1 = AnimElemTime(3) = 3
name = "board"
stateno = 2121
pos = FrontEdgeDist+60, -16
postype = p1
ownpal = 1
ID = 2121
size.ground.back = 3
size.ground.front = 3
size.height = 6
ignorehitpause=1

[State 2120, ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[Statedef 2121]
type    = S
movetype= A
physics = N
velset = -15,0
anim = 2121
ctrl = 0
sprpriority = 2

[State 2121]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 2121]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2121]
type = nothitby
trigger1 = 1
value = SCA

[State 2121]
type = explod
trigger1 = time%2
anim = 2800+random%6
pos = 5-random%10,5-random%10
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
bindtime = 6
ID = 2800
scale = .5,.5
sprpriority = 5
ownpal = 1

[State 2121]
type = velset
trigger1 = 1
x = -15

[State 2121]
type = velset
trigger1 = numtarget(2122)
trigger1 = target(2122),statetype = S || target(2122),statetype = C
x = -10

[State 2121, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 1
attr = S, HP
guardflag = MA
hitflag = MAFD
animtype = hard
damage = ceil(90*parent,FVar(0)),5
priority = 4, Hit
pausetime = 1,0
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = high
ground.slidetime = 8
ground.hittime = 14
guard.ctrltime = 14
yaccel = .53
ground.velocity = 11
guard.velocity = 11
airguard.velocity = 4,-.8
air.velocity = ifelse(parent,var(15),4,-2),ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = 4,-2.5
ground.cornerpush.veloff = 0
sprpriority = -1
forcestand = 1
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(30*parent,fvar(11)), ceil(15*parent,fvar(11))
id = StateNo

[State 2121]
type = Projectile
trigger1 = 1
projID = 2124
projanim = 2121
projscale = 0, 0
projremovetime = 2
offset = 0, 0
postype = p1
attr = S, HT
guardflag = MA
hitflag = +M
animtype = hard
affectteam = B
priority = 4, Hit
pausetime = 0,0
hitsound = -1
guardsound = -1
ground.type = high
ground.slidetime = 8
ground.hittime = 14
guard.ctrltime = 14
ground.velocity = 11
guard.velocity = 11
ground.cornerpush.veloff = 0
sprpriority = -1
id = 2122
numhits = 0

[State 2121]
type = Helper
trigger1 = time = 1
name = "board"
stateno = 2123
ownpal = 1
ID = 2123
ignorehitpause=1

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = parent,fvar(5) > .5
fvar(5) = .5
ignorehitpause = 1

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = ParentVarAdd
trigger1 = MoveContact
trigger1 = parent,Var(12)%100%16 < 8
var(12) = 808
ignorehitpause=1

[State 2121]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6051
pos = -Random%30, 5-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 2121]
type = changestate
trigger1 = parent,var(15) = 0
trigger1 = movehit
trigger1 = parent,p2bodydist X < 45
trigger1 = parent,p2bodydist Y = 0
trigger2 = numhelper(2123)
trigger2 = parent,pos X-helper(2123),Pos X = [-15,15]
trigger3 = time > 33
value = 2122 

[State 2121, ヘルパーを消す]
type = DestroySelf
trigger1 = time > 10 && screenpos X != [-360,360]

[Statedef 2122]
type    = S
movetype= I
physics = N
velset = 1,-2
anim = 2121
ctrl = 0
sprpriority = 2

[State 2122]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2122]
type = nothitby
trigger1 = 1
value = SCA

[State 2122]
type = veladd
trigger1 = pos Y < 0
y = .25

[State 2122]
type = posset
trigger1 = pos Y > 0
y = 0

[State 2122]
type = velset
trigger1 = pos Y >= 0
y = 0

[State 2122]
type = Trans
trigger1 = pos Y = 0
trans = addalpha
alpha =  256-time*8, 256

[State 2122, ヘルパーを消す]
type = DestroySelf
trigger1 = time > 32

[Statedef 2123]
type    = S
movetype= A
physics = N
anim = 2121
ctrl = 0
sprpriority = 2

[State 2123]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2123]
type = nothitby
trigger1 = 1
value = SCA

[State 2123]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6051
pos = -Random%30, 5-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6050

[State 2123, ヘルパーを消す]
type = DestroySelf
trigger1 = parent,stateno != 2121
trigger2 = numhelper(2121) = 0

[State 2123]
Type = AssertSpecial
Trigger1 = 1
flag = invisible
flag = Noshadow
IgnoreHitPause = 1

[State 2123]
type = bindtoparent
trigger1 = numhelper(2121) >= 1

[State 2123, ヒット定義]
type = HitDef
trigger1 = time = 1
attr = S, HP
guardflag = MA
hitflag = MAFD
animtype = hard
affectteam = F
damage = 90,5
priority = 4, Hit
pausetime = 1,0
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = high
ground.slidetime = 10
ground.hittime = 20
guard.ctrltime = 20
yaccel = .53
ground.velocity = 9
guard.velocity = 9
airguard.velocity = 4,-.8
air.velocity = 4,-5.5
down.velocity = 4,-2.5
ground.cornerpush.veloff = 0
sprpriority = -1
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = 2121

;---------------------------------------------------------------------------
;地上電磁跳躍突撃
[Statedef 2200]
type    = S
movetype= A
physics = S
anim = 2200
ctrl = 0
velset = 0,0
sprpriority = 2
facep2 = 1

[State 2200]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 2200]
type = nothitby
trigger1 = animelemno(0) = [2,5]
value = SCA

[State 2200]
type = Helper
trigger1 = animelem = 3 && anim = 2200
name = "spark"
stateno = 1208
pos = 150, -25
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 2200, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = animelemtime(2) = 2 && anim = 2200
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
darken = 0
p2defmul = 1

[State 2200, 超必エフェクト]
type = Helper
trigger1 = animelemtime(2) = 2 && anim = 2200
ignorehitpause=1
stateno = 6500
pos = 6, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2200, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(3)%3 = 0 && animelemno(0) < 11
attr = A, HA
guardflag = MA
hitflag = MAFD
damage = ceil(35*FVar(0)),2
priority = 1, Hit
pausetime = 3, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = High
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -3,-6.2
airguard.velocity = -2.4,-1.6
air.velocity = -3.5,ifelse(var(15),fvar(10),-.53)
down.velocity = -3,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -4*var(15)-4
down.cornerpush.veloff = -8
fall = 1
fall.yvelocity = 0
fall.recover = 0
fall.recovertime = 22
getpower = 0, 0
givepower = ceil(7*fvar(11)), ceil(4*fvar(11))
id = StateNo

[State 2200, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(11) = 0
attr = A, HA
guardflag = MA
hitflag = MAFD
damage = ceil(35*FVar(0)),2
priority = 1, Hit
pausetime = 3, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = High
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -3,-6.2
airguard.velocity = -2.4,-1.6
air.velocity = -2.5,ifelse(var(15),fvar(10),-6.2)
down.velocity = -2,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -4*var(15)-4
down.cornerpush.veloff = -8
fall = 1
fall.yvelocity = 0
fall.recover = 0
fall.recovertime = 22
getpower = 0, 0
givepower = ceil(7*fvar(11)), ceil(4*fvar(11))
id = StateNo

[State 2200]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = animelemtime(11) > 0
fvar(5) = fvar(5)*.7
ignorehitpause=1

[State 2200]
type = PlayerPush
trigger1 = animelemtime(9) >= 0 && animelemtime(12) < 0
value = 0

[State 2200, ステート変更]
type = StateTypeSet
trigger1 = animelemtime(3) = 0 && anim = 2200
statetype = A
movetype = A
physics = A

[State 2200, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 2200
trigger1 = animelem = 4 || animelem = 6
value = 0, 5

[State 2200, ステート変更]
type = velset
trigger1 = anim = 2200 && animelemno(0) = [4,11]
x = 6
y = 0

[State 2200, ステート変更]
type = velset
trigger1 = anim = 2200 && animelemtime(3) = [0,3]
y = -6

[State 2200, ステート変更]
type = veladd
trigger1 = animelemno(0) >6
x = -.1

[State 2200, ステート変更]
type = changestate
trigger1 = Pos Y+Vel Y >= -.5 && animelemtime(8) > 0
value = 1206

[State 2200]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0 && anim = 2200
anim = 2800+random%6
pos = 15, 0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;空中電磁跳躍突撃
[Statedef 2205]
type    = A
movetype= A
physics = A
anim = 2200
ctrl = 0
velset = 0,0
sprpriority = 2
facep2 = 1

[State 2205]
type = VarSet
trigger1 = Time = 0
var(8) = 1

[State 2205]
type = nothitby
trigger1 = animelemno(0) = [2,5]
value = SCA

[State 2205]
type = Helper
trigger1 = animelem = 2 && anim = 2200
name = "spark"
stateno = 1208
pos = 150, -25
postype = p1
ownpal = 1
ID = 1207
ignorehitpause=1

[State 2205, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = animelemtime(2) = 1 && anim = 2200
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
darken = 0
p2defmul = 1

[State 2205, 超必エフェクト]
type = Helper
trigger1 = animelemtime(2) = 1 && anim = 2200
ignorehitpause=1
stateno = 6500
pos = 6, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2205, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(3)%3 = 0 && animelemno(0) < 11
attr = A, HA
guardflag = MA
hitflag = MAFD
damage = ceil(60*FVar(0)),2
priority = 1, Hit
pausetime = 3, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = High
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -3,-6.2
airguard.velocity = -2.4,-.8
air.velocity = -3.5,ifelse(var(15),fvar(10),-.53)
down.velocity = -3,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -4*var(15)-4
down.cornerpush.veloff = -8
fall = 1
fall.yvelocity = 0
fall.recover = 0
fall.recovertime = 22
getpower = 0, 0
givepower = ceil(7*fvar(11)), ceil(4*fvar(11))
id = StateNo

[State 2205, ヒット定義]
type = HitDef
triggerall = var(7) < 30
trigger1 = animelemtime(11) = 0
attr = A, HA
guardflag = MA
hitflag = MAFD
damage = ceil(50*FVar(0)),2
priority = 1, Hit
pausetime = 3, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = High
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -3,-6.2
airguard.velocity = -2.4,-1.6
air.velocity = -2.5,ifelse(var(15),fvar(10),-6.2)
down.velocity = -2,-2.5
ground.cornerpush.veloff = -4
air.cornerpush.veloff = -4*var(15)-4
down.cornerpush.veloff = -8
fall = 1
fall.yvelocity = 0
fall.recover = 0
fall.recovertime = 22
getpower = 0, 0
givepower = ceil(7*fvar(11)), ceil(4*fvar(11))
id = StateNo

[State 2205]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = fvar(5) > .5
fvar(5) = .5
ignorehitpause=1

[State 2205]
type = PlayerPush
trigger1 = animelemtime(9) >= 0 && animelemtime(12) < 0
value = 0

[State 2205, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 2200
trigger1 = animelem = 3 || animelem = 5
value = 0, 5

[State 2205, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 2200
trigger1 = animelem = 4 || animelem = 6
value = 0, 5

[State 2205, ステート変更]
type = posadd
trigger1 = anim = 2200
trigger1 = animelemtime(3) = 0 || animelemtime(4) = 0
y = -5

[State 2205, ステート変更]
type = velset
trigger1 = anim = 2200 && animelemno(0) = [2,11]
y = 0

[State 2205, ステート変更]
type = velset
trigger1 = anim = 2200 && animelemno(0) = [4,11]
x = 6

[State 2205, ステート変更]
type = velset
trigger1 = anim = 2200 && animelemtime(3) = [0,3]
y = -6

[State 2205, ステート変更]
type = veladd
trigger1 = animelemno(0) >6
x = -.1

[State 2205, ステート変更]
type = changestate
trigger1 = Pos Y+Vel Y >= -.5 && animelemtime(8) > 0
value = 1206

[State 2205]
type = explod
trigger1 = animelemtime(3) >= 0 && animelemtime(9) < 0 && anim = 2200
anim = 2800+random%6
pos = 15, 0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,10
scale = .5,.5
ID = 2800
sprpriority = 5
ownpal = 1
removeongethit = 1

;---------------------------------------------------------------------------
;磁性操作雷
[Statedef 2320]
type    = A
movetype= A
physics = A
ctrl = 0
anim = 1300
sprpriority = 2

[State 2320]
type = changeanim
triggerall = animelemno(0) = 2
trigger1 = time = 6
value = 1300
elem = 3

[State 2320]
type = velset
trigger1 = animelemtime(3) < 0
x = 0
y = 0

[State 2320]
type = velset
trigger1 = animelemtime(3) = 0
x = -1.5
y = -7

[State 2320]
type = Helper
trigger1 = animelemtime(3) = 0
name = "framework"
stateno = 2321
pos = 25,25-ceil(screenpos Y)
ownpal = 1
ID = 2321

[State 2320]
type = varset
trigger1 = AnimElemTime(3) = 0 && var(21) != 3
var(6) = 450
ignorehitpause=1

[State 2320, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0 
value = 0, 5

[State 2320, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = animelemtime(2) = 2
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
darken = 0
p2defmul = 1

[State 2320, 超必エフェクト]
type = Helper
trigger1 = animelemtime(2) = 2
ignorehitpause=1
stateno = 6500
pos = -6, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2320]
type = StateTypeSet
trigger1 = AnimElemTime(5) = 0 
movetype= I

[Statedef 2321]
type    = S
movetype= A
physics = N
ctrl = 0
anim = 2321
sprpriority = -1

[State 2321]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2321]
type = nothitby
trigger1 = 1
value = SCA

[State 2321]
type = velset
trigger1 = time = 0
x = .5
y = 26

[State 2321]
type = changeanim
trigger1 = pos Y > 0
value = 2322

[State 2321]
type = velset
trigger1 = pos Y > 0
x = 0
y = 0

[State 2321]
type = posset
trigger1 = pos Y > 0
y = 0

[State 2321]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 2321]
type = explod
trigger1 = animelemno(0) = 1 || animelemtime(2) = [100,130]
anim = 2800+random%6
pos = 0, -50
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,100
scale = .5,.5
ID = 2800
sprpriority = 3
ownpal = 1
removeongethit = 1
persistent = 4

[State 2321, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(2) = [100,130]
value = 0, 5
persistent = 10

[State 2321, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = A, HP
guardflag = HA
hitflag = MAFD
damage = ceil(140*parent,FVar(0)),15
priority = 4, Hit
pausetime = 0, 2
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = 0,26
airguard.velocity = -3.6,-.8
air.velocity = -2.6*parent,var(15),ifelse(parent,var(15),parent,fvar(10),26)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(30*parent,fvar(11)), ceil(15*parent,fvar(11))
id = StateNo

[State 2321, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = anim = 2322 && animelemtime(1) = 0
attr = S, NA
guardflag = MA
hitflag = MAFD
damage = ceil(100*parent,FVar(0)),5
priority = 4, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = -3.6,-5
airguard.velocity = -3.6,-.8
air.velocity = -2.4*parent,var(15)-2.4,ifelse(parent,var(15),parent,fvar(10),-5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(15*parent,fvar(11)), ceil(7*parent,fvar(11))
id = StateNo

[State 2321]
type = Explod
trigger1 = anim = 2322 && animelemtime(1) = 0
anim = 15100
ID = 15100
pos = 0, 0
postype = p1
scale = .5, .5
sprpriority = 3
ownpal = 1

[State 2321, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 2322 && animelemtime(1) = 0
value = 5100, 1

[State 2321]
type = StateTypeSet
trigger1 = anim = 2322 && animelemtime(1) = 0
statetype = S
movetype = A
physics = N

[State 2321]
type = StateTypeSet
trigger1 = anim = 2322 && animelemtime(1) = 4
statetype = S
movetype = I
physics = N

[State 2321]
type = StateTypeSet
trigger1 = anim = 2322 && animelemtime(3) = -4
statetype = S
movetype = A
physics = N

[State 2321, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = anim = 2322 && animelemtime(3) = 0
attr = S, NA
guardflag = MA
hitflag = MAFD
damage = ceil(160*parent,FVar(0)),15
priority = 4, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 7
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = 0,-7
airguard.velocity = -3.6,-.8
air.velocity =-2.4*parent,var(15),ifelse(parent,var(15),parent,fvar(10),-5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(30*parent,fvar(11)), ceil(15*parent,fvar(11))
id = StateNo

[State 2321]
type = SprPriority
trigger1 = anim = 2322 && animelemno(0) = 2
value = -1

[State 2321]
type = SprPriority
trigger1 = anim = 2322 && animelemtime(3) = 0
value = 4

[State 2321]
type = Explod
trigger1 = anim = 2322 && animelemtime(3) = 0
anim = 2324
ID = 2324
pos = 0, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 2321]
type = Explod
trigger1 = anim = 2322 && animelemtime(3) = 0
anim = 2323
ID = 2323
pos = 0, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 2321]
type = Explod
trigger1 = anim = 2322 && animelemtime(3) = 0
anim = 2325
ID = 2325
pos = 0, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 2321]
type = explod
trigger1 = anim = 2322 && animelemtime(3) = 0
anim = 2425
pos = 0, -30
postype = p1
scale = .75,.75
ID = 2425
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 2321, 音を鳴らす]
type = PlaySnd
trigger1 = anim = 2322 && animelemtime(3) = 0
value = 0, 6

[State 2321]
type = bgpalfx
trigger1 = anim = 2322 && animelemtime(3) = [-4,-1]
time = 1
mul = -animelemtime(3)*48-16,-animelemtime(3)*48-16,-animelemtime(3)*48-16

[State 2321]
type = bgpalfx
trigger1 = anim = 2322 && animelemtime(3) = [0,5]
time = 1
add = 64,64,64

[State 2321]
type = bgpalfx
trigger1 = anim = 2322 && animelemtime(3) = [5,10]
time = 1
mul = 64,64,64

[State 2321]
type = bgpalfx
trigger1 = anim = 2322 && animelemtime(3) > 10
time = 1
mul = animelemtime(3)*8-24,animelemtime(3)*8-24,animelemtime(3)*8-24

[State 2321]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 2321]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = 15-Random%30, 15-Random%30
postype = p1
supermovetime = 9999
ownpal = 1
ID = 6000

[State 2321, ヘルパーを消す]
type = DestroySelf
trigger1 = anim = 2322 && animtime = -1

;---------------------------------------------------------------------------
;招雷
[Statedef 2420]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2420
ctrl = 0
sprpriority = 2

[State 2420]
type = nothitby
trigger1 = animelemno(0) = [0,6]
value = SCA

[State 2420, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 0, 6

[State 2420, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(5) = 0
value = 0, 10

[State 2420, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = animelemtime(4) = 0
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1000)
movetime = 36
darken = 0
p2defmul = 1

[State 2420, 超必エフェクト]
type = Helper
trigger1 = animelemtime(4) = 0
ignorehitpause=1
stateno = 6500
pos = 7, -35
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2420]
type = varset
trigger1 = animelemtime(5) = 0 && var(21) != 3
var(6) = 450
ignorehitpause=1

[State 2420]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2324
pos = 7, -35
postype = p1
facing = 1-random%2*2
scale = .75,.75
ID = 2324
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 2420]
type = explod
trigger1 = animelemtime(5) = 0
anim = 2425
pos = 7, -35
postype = p1
scale = .75,.75
ID = 2806
sprpriority = 3
ownpal = 1
removeongethit = 1

[State 2420, エフェクト]
type = Helper
trigger1 = animelemtime(4) = 30
name = "spark"
stateno = 2421
pos = 0, 0
postype = p1
ownpal = 1
ID = 2421

[State 2420]
type = explod
trigger1 = animelemno(-1) = [1,4]
anim = 2806+random%6
pos = 0, -20
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 10,20
scale = .5,.5
ID = 2806
sprpriority = 3
ownpal = 1
supermovetime = 36
removeongethit = 1
persistent = 6

[State 2420, ヒット定義]
type = HitDef
trigger1 = animelemno(0) = 5
trigger1 = movecontact = 0 && movereversed = 0
attr = S, NA
guardflag = M
hitflag = MAFD
damage = ceil(190*FVar(0)),15
priority = 4, Hit
pausetime = 0, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 7
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .45
ground.velocity = -2.4,-7.5
airguard.velocity = -3.6,-.8
air.velocity =-3.6*var(15),ifelse(var(15),fvar(10),-7.5)
down.velocity = -4.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = (P2MoveType!=A)
fall.recovertime = 32
getpower = 0, 0
givepower = ceil(40*fvar(11)), ceil(20*fvar(11))
id = StateNo

[State 2420]
type = bgpalfx
trigger1 = animelemno(0) = [4,5]
time = 1
mul = 64,64,64

[State 2420, 補正]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = FVar(5) > .65
fvar(5) = .65
ignorehitpause=1

[State 2420, ステート変更]
type = ChangeState
trigger1 = animtime = 0
value = 0
ctrl = 1

[Statedef 2421]
type    = S
movetype= I
physics = N
anim = 1
ctrl = 0

[State 2421]
type = bgpalfx
trigger1 = time < 4
time = 1
mul = 64,64,64

[State 2421]
type = bgpalfx
trigger1 = time = [4,7]
time = 1
add = 64,64,64

[State 2421]
type = bgpalfx
trigger1 = time = [8,13]
time = 1
mul = 64,64,64

[State 2421]
type = bgpalfx
trigger1 = time > 13
time = 1
mul = time*8-48,time*8-48,time*8-48

[State 2421, エフェクト]
type = DestroySelf
trigger1 = time = 35

;---------------------------------------------------------------------------
;ミサカウェーブ
[Statedef 2500]
type    = S
movetype= A
physics = S
velset = 0, 0
anim = 2500
ctrl = 0
sprpriority = 2
facep2 = 1

[State 2500, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(3) = 0
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1500)
darken = 0
p2defmul = 1

[State 2500, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(3) = 0
ignorehitpause=1
stateno = 6500
pos = 12, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2500, ヘルパーを出す];ウェーブ
type = Helper
trigger1 = AnimElemNo(0)>3 && Time%4=1
trigger1 = NumHelper(2510)<8
name = "misaka_wave-u"
stateno = 2510
pos = Time*6-36,0
postype = p1
ownpal = 1
ID = 2510

[State 2500, ステート変更]
type = ChangeState
trigger1 = Time = 60
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ミサカイリュージョン
[Statedef 2501]
type    = S
movetype= A
physics = S
velset = 0, 0
anim = 2500
ctrl = 0
sprpriority = 2
facep2 = 1

[State 2501, ヘルパーを出す]
type = Helper
trigger1 = AnimElemTime(3) = 0
Persistent = 0
name = "misaka_illusion"
stateno = 2520
pos = -16,0
postype = p1
supermovetime = 31
ownpal = 1
ID = 2520

[State 2501, ヘルパーを出す]
type = Helper
trigger1 = AnimElemTime(3) = 0
Persistent = 0
name = "misaka_illusion"
stateno = 2521
pos = -32,0
postype = p1
supermovetime = 30
ownpal = 1
ID = 2521

[State 2501, ヘルパーを出す]
type = Helper
trigger1 = AnimElemTime(3) = 0
Persistent = 0
name = "misaka_illusion"
stateno = 2521
pos = -48,0
postype = p1
supermovetime = 26
ownpal = 1
ID = 2521

[State 2501, ヘルパーを出す]
type = Helper
trigger1 = AnimElemTime(3) = 0
Persistent = 0
name = "misaka_illusion"
stateno = 2521
pos = -64,0
postype = p1
supermovetime = 22
ownpal = 1
ID = 2521

[State 2501, ヘルパーを出す]
type = Helper
trigger1 = AnimElemTime(3) = 0
Persistent = 0
name = "misaka_illusion"
stateno = 2521
pos = -80,0
postype = p1
supermovetime = 18
ownpal = 1
ID = 2521

[State 2501, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(3) = 0
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1500)
darken = 0
p2defmul = 1

[State 2501, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(3) = 0
ignorehitpause=1
stateno = 6500
pos = 12, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2501, ステート変更]
type = ChangeState
trigger1 = Time = 120
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ミサカネットワーク
[Statedef 2502]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 2500
ctrl = 0
sprpriority = 2
facep2 = 1

[State 2502, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(3) = 0
time = 36
anim = -1
sound = s1500, 0
poweradd = ifelse(var(21)=3,-500,-1500)
darken = 0
p2defmul = 1

[State 2520, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(3) = 0
ignorehitpause=1
stateno = 6500
pos = 12, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 2530, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(4) = 0
value = s2530, 0

[State 2502, ヘルパーを出す];シスターズ
type = Helper
trigger1 = AnimElemTime(4) = 0
Persistent = 0
name = "misaka_network"
stateno = 2530
pos = -60,3
postype = Back
ownpal = 1
ID = 2530

[State 2503, ヘルパーを出す];ラストオーダー
type = Helper
trigger1 = AnimElemTime(4) = 0
Persistent = 0
name = "last-order"
stateno = 2531
pos = -30,5
postype = Back
ownpal = 1
ID = 2550

[State 2502, ヘルパーを出す];ワースト
type = Helper
trigger1 = AnimElemTime(4) = 0
Persistent = 0
name = "worst"
stateno = 2532
pos = -360,-175
postype = Back
ownpal = 1
ID = 2560

[State 2502, ステート変更]
type = ChangeState
trigger1 = Time = 120
value = 0
ctrl = 1

;---------------------------------------------------------------------------
;ウェーブ
[Statedef 2510]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2510
sprpriority = 3

[State 2510]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2510]
type = nothitby
trigger1 = 1
value = SCA

[State 2510, 速度]
type = VelSet
trigger1 = time = 4
y = -10

[State 2510, エフェクト]
type = Explod
trigger1 = time < 4
anim = 2515
ID = 2515
vel = 0, 0
postype = p1
vel = -.01, 0
accel = (1-Time%2*2)*(random%5*.01+.02),-random%3*.01
facing = random%2*2-1
vfacing = random%2*2-1
supermovetime = 30
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1

[State 2510, 速度]
type = Gravity
trigger1 = pos Y < 0

[State 2510, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = Time = 4
attr = S, SA
hitflag = MAFD
pausetime = 0, 3
guardflag = MA
animtype  = up
damage = ceil(80*parent,FVar(0))
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound   = s1, 2
guardsound = s1, 11
ground.type = High
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = 0,-13
air.velocity = 0,ifelse(parent,var(15),parent,fvar(10),-11)
down.velocity = 0,-2.5
guard.velocity = -4
airguard.velocity = -0,-2
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(15*parent,fvar(11)), ceil(7*parent,fvar(11))
id = StateNo

[State 2510]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = parent,FVar(5) > .5
fvar(5) = .5
ignorehitpause=1

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6001
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 2510, 下降]
type = ChangeAnim
trigger1 = time > 4 && Anim = 2510
trigger1 = Vel Y > -2
value = 2511

[State 2510, エフェクト]
type = Explod
trigger1 = Anim = 2512
trigger1 = AnimElemTime(3) = [0,4]
anim = 2515
ID = 2515
vel = 0, 0
postype = p1
vel = -.01, 0
accel = (1-Time%2*2)*(random%5*.01+.02),-random%3*.01
facing = random%2*2-1
vfacing = random%2*2-1
supermovetime = 30
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1

[State 2510, 着地]
type = ChangeAnim
trigger1 = pos Y >= -5
trigger1 = Anim = 2511
value = 2512

[State 2510, 着地]
type = PosSet
trigger1 = Anim = 2512
y = 0

[State 2510, 着地]
type = VelSet
trigger1 = Anim = 2512
y = 0

[State 2510, ヘルパーを消す]
type = DestroySelf
trigger1 = Anim = 2512
trigger1 = AnimTime = 0

;---------------------------------------------------------------------------
;イリュージョン
[Statedef 2520]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2520
sprpriority = 2

[State 2520]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2520]
type = nothitby
trigger1 = 1
value = SCA

[State 2520, 音を鳴らす]
type = PlaySnd
trigger1 = animelemtime(9) = 18
value = s2520, 0

[State 2520, 開始]
type = ChangeAnim
trigger1 = animelemtime(9) = 18
value = 2521

[State 2520, エフェクト]
type = Explod
trigger1 = Time = 42
anim = 2525
ID = 2525
pos = -36,0
postype = p1
bindtime = -1
removetime = -1
sprpriority = 1
ownpal = 1
trans = Add

[State 2520, 速度]
type = VelSet
trigger1 = Time >= 42
trigger1 = Time < 50
x = 2

[State 2520, 速度]
type = VelSet
trigger1 = Time >= 50
x = 4

[State 2520, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = Time%6 = 0 && Time >= 42
attr = S, SA
hitflag = MAFDP
guardflag = MA
animtype = Medium
damage = ceil(20*parent,FVar(0)),1
pausetime = 0, 4
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound  = s1, 4
guardsound = s1, 11
ground.type = High
ground.slidetime = 15
ground.hittime = 15
yaccel = .53
ground.velocity = -8.5
air.velocity = 4.5*parent,var(15)-8.5,ifelse(parent,var(15),parent,fvar(10),-3.2)
down.velocity = -4,-2.5
guard.velocity = -10
airguard.velocity = -8.5,-.8
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(4*parent,fvar(11)), ceil(2*parent,fvar(11))
id = StateNo

[State 2520, エフェクト]
type = Explod
trigger1 = Time < 5
anim = 2515
ID = 2515
pos = 0,0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+.02),-random%3*.01
facing = random%2*2-1
vfacing = random%2*2-1
supermovetime = 30
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1

[State 2520]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
trigger1 = parent,FVar(5) > 0.01
fvar(5) = parent,FVar(5)*.95
ignorehitpause=1

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
ignorehitpause=1
var(0) = Ifelse(ceil((time%32+1)/4)%2,Ifelse(ceil((time%32+1)/4)%4=1,0,18),12)*Ifelse(ceil((time%32+1)/4)>5,-1,1)

[State -1]
type = VarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
ignorehitpause=1
var(1) = Ifelse(ceil((time%32+1)/4)%2,Ifelse(ceil((time%32+1)/4)%4=1,39,0),26)*Ifelse(ceil((time%32+1)/4)>3,Ifelse(ceil((time%32+1)/4)<7,-1,1),1)

[State -1]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6000
pos = var(0), var(1)-39
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 2520]
type = RemoveExplod
trigger1 = Facing = 1
trigger1 = pos X >= 300
trigger2 = Facing = -1
trigger2 = pos X <= -300
ID = 2525

[State 2520, ヘルパーを消す]
type = DestroySelf
trigger1 = Time > 43
trigger1 = NumExplod(2525) = 0

[Statedef 2521]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2520
sprpriority = 2

[State 2520, エフェクト]
type = Explod
trigger1 = Time < 5
anim = 2515
ID = 2515
pos = 0,0
postype = p1
vel = 0, 0
accel = (1-Time%2*2)*(random%5*.01+.02),-random%3*.01
facing = random%2*2-1
vfacing = random%2*2-1
supermovetime = 30
scale = 0.5, 0.5
sprpriority = 4
ownpal = 1

[State 2520, 開始]
type = ChangeAnim
trigger1 = animelemtime(9) = 22
value = 2521

[State 2520, 速度]
type = VelSet
trigger1 = Time >= 42
trigger1 = Time < 50
x = 2

[State 2520, 速度]
type = VelSet
trigger1 = Time >= 50
x = 4

[State 2520]
type = DestroySelf
trigger1 = Numhelper(2520) = 0

;---------------------------------------------------------------------------
;シスターズ
[Statedef 2530]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2530
sprpriority = 2

[State 2530]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2530]
type = nothitby
trigger1 = 1
value = SCA

[State 2530];表示優先度操作
type = SprPriority
trigger1 = 1
value =0

[State 2530, 速度]
type = VelSet
trigger1 = 1
x = 6.5

[State 2530, 画面振動]
type = EnvShake
trigger1 = Time = 0
time = 180
ampl = 3
freq = 90

[State 2530, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = 1
attr = S, SA
hitflag = MAFD
guardflag = MA
animtype = Hard
damage    = ceil(25*parent,FVar(0))
pausetime = 0, ifelse(p2statetype=A,6,4)
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound   = s1, 2
guardsound = s1, 11
ground.type = trip
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -1.5,-3.5
air.velocity = -1.5*parent,var(15)-1.5,ifelse(parent,var(15),parent,fvar(10),-3.5)
down.velocity = -3,-2.5
guard.velocity = -1.5
airguard.velocity = 0
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(4*parent,fvar(11)), ceil(2*parent,fvar(11))
id = StateNo

[State -1];コンボ数
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6000
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 2530, ヘルパーを消す]
type = DestroySelf
trigger1 = Time = 150

;---------------------------------------------------------------------------
;ラストオーダー
[Statedef 2531]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2531
sprpriority = 4

[State 2531]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2531]
type = nothitby
trigger1 = 1
value = SCA

[State 2531];表示優先度操作
type = SprPriority
trigger1 = 1
value =3

[State 2531, 速度]
type = VelSet
trigger1 = 1
x = 2.8

[State 2531, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = movecontact =0
attr = S, SA
hitflag = MFD
guardflag = L
animtype  = Medium
damage    = ceil(15*parent,fvar(0))
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
ground.type = low
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -1.5,-3.5
air.velocity = -1.5*parent,var(15)-1.5,ifelse(parent,var(15),parent,fvar(10),-3.5)
down.velocity = -3,-2.5
guard.velocity = -1.5
airguard.velocity = 0
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0,0
givepower = ceil(8*parent,fvar(11)), ceil(4*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause=1

[State -1];コンボ数
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6000
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 2531, ヘルパーを消す]
type = DestroySelf
trigger1 = Time = 150

;---------------------------------------------------------------------------
;ワースト
[Statedef 2532]
type     = S
movetype = A
physics  = N
ctrl     = 0
anim     = 2532
sprpriority = 3

[State 2532]
type = hitoverride
trigger1 = 1
attr = SCA

[State 2532]
type = nothitby
trigger1 = 1
value = SCA

[State 2532, エフェクト]
type = Explod
trigger1 = Time = 0
anim = 2533
ID = 2533
pos = 0,0
postype = p1
bindtime = -1
removetime = 150
sprpriority = 1
ownpal = 1

[State 2532, 速度]
type = VelSet
trigger1 = 1
x = 13
y = 1.6

[State 2532, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = movecontact =0
attr = S, SA
hitflag = MAFD
guardflag = HA
animtype  = Medium
damage    = ceil(30*parent,fvar(0))
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound   = s1, 5
guardsound = s1, 11
ground.type = Low
ground.slidetime = 13
ground.hittime  = 13
yaccel = .53
ground.velocity = -7,-2.5
air.velocity = -12,ifelse(parent,var(15),parent,fvar(10),6)
down.velocity = -12,-2.5
guard.velocity = -9
airguard.velocity = -9,4
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0,0
givepower = ceil(8*parent,fvar(11)), ceil(4*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarSet
trigger1 = MoveHit = 1
fvar(5) = parent,fvar(5)*.85
ignorehitpause=1

[State -1];コンボ数
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = Random%30, 10-Random%30
postype = p1
supermovetime = 20
ownpal = 1
ID = 6000

[State 2532, ヘルパーを消す]
type = DestroySelf
trigger1 = Time = 150

;---------------------------------------------------------------------------
;レールガン
[Statedef 3000]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3000
ctrl = 0
sprpriority = 2

[State 3000]
type = nothitby
trigger1 = AnimElemTime(3) = [0,36]
trigger2 = AnimElemTime(4) >= 0 && time < 78
value = SCA

[State 3000]
type = Helper
trigger1 = AnimElemTime(4) = 0 && anim = 3000
stateno = 3002
pos = 12, -20
postype = p1
supermovetime = 36
ID = 3002

[State 3000, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(3) = 0 && anim = 3000
time = 36
anim = -1
sound = s1500, 0
movetime = 36
poweradd = -3000 ;パワーゲージ増減量
darken = 0
p2defmul = 1

[State 3000]
type = powerset
triggerall = var(21) = 1
trigger1 = AnimElemTime(3) = 0 && anim = 3000
value = 1000

[State 3000]
type = varset
trigger1 = AnimElemTime(3) = 0 && anim = 3000
var(21) = 0

[State 3000, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0 && anim = 3000
value = 0, 7

[State 3000, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(3) = 0 && anim = 3000
ignorehitpause=1
stateno = 6500
pos = 12, -22
postype = p1
supermovetime = 36
ownpal = 1
ID = 6500

[State 3000]
type = Helper
trigger1 = AnimElemTime(6) = 0 && anim = 3000
name = "spark"
stateno = 3003
pos = -30, -20
postype = p1
ownpal = 1
ID = 3003
ignorehitpause=1

[State 3000]
type = varset
trigger1 = AnimElemTime(6) = 0 && anim = 3000 && var(21) != 3
var(6) = 450
ignorehitpause=1

[State 3000, 音を鳴らす]
type = PlaySnd
trigger1 = time = 78 || time = 88 || time = 93 || time = 98
value = 0, 5

[State 3000]
type = bgpalfx
trigger1 = time = [24,51]
time = 1
mul = 64,64,64

[State 3000]
type = bgpalfx
trigger1 = time = [52,53]
time = 1
add = 256,256,256

[State 3000]
type = bgpalfx
trigger1 = time = [54,86]
time = 1
mul = (time-54)*8,(time-54)*8,(time-54)*8

[State 3000]
type = explod
trigger1 = time = [78,100]
anim = 2806+random%6
pos = 0, -25
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 15,20
scale = .5,.5
ID = 2806
sprpriority = 3
ownpal = 1
removeongethit = 1
persistent = 6

[State 3000]
type = Changeanim
trigger1 = time= 130 && anim = 3000
value = 3001
persistent = 0

[State 3000, エフェクト]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 102
ID = 102
postype = p1
sprpriority = 3
ownpal = 1

[State 3000, エフェクト]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 3004
ID = 3004
pos = 0, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 3000]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 3111
ID = 3111
pos = 45, 0
postype = p1
facing = 1
sprpriority = 3
ownpal = 1

[State 3000, エフェクト]
type = Explod
trigger1 = time = 78
anim = 3006
ID = 3006
pos = 25, -22
postype = p1
scale = 1.25, .75
sprpriority = 3
ownpal = 1

[State 3000, ステート変更]
type = ChangeState
trigger1 = animtime= 0 && anim = 3001
value = 0
ctrl = 1

[Statedef 3002]
type    = S
movetype= A
physics = N
anim = 3002
velset = 0, -7
ctrl = 0
sprpriority = 4

[State 3002]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 3002, 速度]
type = veladd
trigger1 = 1
y = .35

[State 3002]
type = Trans
trigger1 = 1
trans = addalpha
alpha =  abs(256-((time-16)%32*12))+64, 256

[State 3002]
type = AngleDraw
trigger1 = 1
scale = .5, .5
value = -time*9

[State 3002, ヘルパーを消す]
type = DestroySelf
trigger1 = parent,AnimElemTime(6) = 0 && parent,anim = 3000
trigger2 = AnimTime = 0

[Statedef 3003]
type    = S
movetype= A
physics = N
anim = 3003
ctrl = 0
sprpriority = 4

[State 3003]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3003]
type = nothitby
trigger1 = 1
value = SCA

[State 3003]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 3003]
type = Trans
trigger1 = 1
trans = addalpha
alpha = 256-(time*18), 256

[State 3003]
type = AngleDraw
trigger1 = 1
scale = .5, .5
ignorehitpause=1

[State 3003, 速度]
type = VelSet
trigger1 = 1
x = 45

[State 3003, 音を鳴らす]
type = PlaySnd
trigger1 = Time = 0
channel = 9
volume = 255
value = 0, 8

[State 3003, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = 0
attr = S, HP
guardflag = H
hitflag = MAFD
animtype = back
damage = ceil(315*parent,FVar(0))+50,30
priority = 4, Hit
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s0, 11
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
guard.slidetime = 36
ground.hittime = 18
guard.hittime = 36
yaccel = .53
ground.velocity = -5.6,-6.5
guard.velocity = -13.2
airguard.velocity = -2.4,-.8
air.velocity = -1.6*parent,var(15)-5.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -7.2,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(120*parent,fvar(11)), ceil(60*parent,fvar(11))
id = StateNo

[State 3003, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = movecontact = 0 && movereversed = 0 && time > 0
attr = S, HP
guardflag = MA
hitflag = MAFD
animtype = back
damage = ceil(270*parent,FVar(0))+50,20
priority = 4, Hit
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s0, 11
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
guard.slidetime = 36
ground.hittime = 18
guard.hittime = 36
yaccel = .53
ground.velocity = -5.6,-6.5
guard.velocity = -13.2
airguard.velocity = -2.4,-.8
air.velocity = -1.6*parent,var(15)-5.6,ifelse(parent,var(15),parent,fvar(10),-6.5)
down.velocity = -7.2,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(120*parent,fvar(11)), ceil(60*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 3003, エフェクト]
type = Explod
trigger1 = time = [2,5]
anim = 3005
ID = 3005
pos = -105-time*35, 22
postype = p1
scale = .3+time*.1, .3+time*.1
sprpriority = 3
ownpal = 1

[State 3003, エフェクト]
type = Explod
trigger1 = time%2 = 0
anim = 103
ID = 103
pos = 0,22
postype = p1
sprpriority = 3
ownpal = 1

[State 3003]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3003, ヘルパーを消す]
type = DestroySelf
trigger1 = AnimTime = 0

;---------------------------------------------------------------------------
;only my railgun
[Statedef 3050]
type    = S
movetype= A
physics = S
velset = 0,0
anim = 3050
ctrl = 0
sprpriority = 2

[State 3050]
type = posadd
trigger1 = AnimElemTime(7) = 0 || AnimElemTime(9) = 0 || AnimElemTime(11) = 0
x = 6

[State 3050]
type = changeanim
trigger1 = numhelper(3051)
trigger1 = helper(3051),time = 32
value = 3050
elem = 6

[State 3050]
type = nothitby
trigger1 = AnimElemTime(2) = [4,32]
value = SCA

[State 3050, 超必殺技暗転時間停止]
type = SuperPause
trigger1 = AnimElemTime(2) = 5
time = 57
anim = -1
sound = s1500, 0
movetime = 57
poweradd = -3000
darken = 0
p2defmul = 1

[State 3050, 超必エフェクト]
type = Helper
trigger1 = AnimElemTime(2) = 5
ignorehitpause=1
stateno = 6500
pos = 12, -22
postype = p1
supermovetime = 100
ownpal = 1
ID = 6500

[State 3050]
type = varset
trigger1 = AnimElemTime(2) = 5
var(21) = 0

[State 3050]
type = powerset
trigger1 = AnimElemTime(2) = 5
value = 0

[State 3050]
type = Helper
trigger1 = AnimElemTime(3) = 16
name = "arm"
stateno = 3051
pos = 23, -20
postype = p1
supermovetime = 12
ownpal = 1
ID = 3051
ignorehitpause=1

[State 3050, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemNo(0) = [2,5]
value = 0, 5
persistent = 10

[State 3050, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(4) = 0
value = 0, 8

[State 3050, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(4) = 0
value = 1, 7

[State 3050, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(6) = 0
value = 0, 11

[State 3050]
type = EnvShake
trigger1 = AnimElemTime(6) = [0,80]
time = 10
freq = 140-AnimElemTime(6)
ampl = AnimElemTime(6)-36
persistent = 10

[State 3050]
type = varset
trigger1 = AnimElemTime(6) = 0
var(6) = 450
ignorehitpause=1

[State 3050]
type = bgpalfx
trigger1 = AnimElemTime(2) > 22 && AnimElemNo(0) = [2,5]
time = 1
mul = 64,64,64

[State 3050]
type = bgpalfx
trigger1 = AnimElemTime(6) = [1,2]
time = 1
add = 256,256,256

[State 3050]
type = bgpalfx
trigger1 = AnimElemTime(6) = [3,33]
time = 1
mul = (AnimElemTime(6)-2)*8,(AnimElemTime(6)-2)*8,(AnimElemTime(6)-2)*8

[State 3050]
type = explod
trigger1 = AnimElemNo(0) = [2,5]
anim = 622
ID = 622
pos = 0, -20
postype = p1
random = 20,40
sprpriority = 4
ownpal = 1
supermovetime = 9999
ignorehitpause=1

[State 3050]
type = explod
trigger1 = random%2 && AnimElemNo(0) = [2,5]
anim = 627
ID = 627
pos = 0, -30
postype = p1
random = 50,60
scale = (time*gametime%10+10)*.01,(time*gametime%10+10)*.01
sprpriority = 4
ownpal = 1
supermovetime = 9999
ignorehitpause=1

[State 3050]
type = explod
trigger1 = random%2 && AnimElemNo(0) = [2,5]
anim = 2806+random%6
pos = 0, -30
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 50,60
scale = .5,.5
ID = 2806
sprpriority = 3
supermovetime = 9999
ownpal = 1

[State 3050, エフェクト]
type = Explod
trigger1 = AnimElemTime(4) = 0
anim = 3005
ID = 3005
pos = 30, 0
postype = p1
scale = .5, .5
facing = -1
sprpriority = 3
ownpal = 1

[State 3050]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3111
ID = 3111
pos = 45, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 3050]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3055
ID = 3055
pos = 40, -20
scale = 2, 1
postype = p1
sprpriority = 3
ownpal = 1

[State 3000, エフェクト]
type = Explod
trigger1 = animelemtime(8) = 0 || animtime= 0
anim = 3006
ID = 3006
pos = 25, -22
postype = p1
scale = 1.25, 1
sprpriority = 3
ownpal = 1

[State 3050, ステート変更]
type = ChangeState
trigger1 = animtime= 0
value = 0
ctrl = 1

[Statedef 3051]
type    = S
movetype= A
physics = N
anim = 3051
ctrl = 0
sprpriority = 2

[State 3051]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3051]
type = nothitby
trigger1 = 1
value = SCA

[State 3051]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 40, 20
postype = p1
scale = 2.5, 1.5
sprpriority = 4
supermovetime = 9999
ownpal = 1

[State 3051]
type = PlaySnd
trigger1 = time = 0
value = 3101, 0

[State 3051]
Type = AssertSpecial
Trigger1 = 1
flag = Noshadow
IgnoreHitPause = 1

[State 3051, 速度]
type = VelSet
trigger1 = time = 33
x = 45

[State 3051]
type = PalFx
trigger1 = time = [16,31]
time = 1
mul = 256,512-time*16,512-time*16
IgnoreHitPause = 1

[State 3051]
type = PalFx
trigger1 = time > 31
time = 1
mul = 256,0,0
IgnoreHitPause = 1

[State 3051]
type = explod
trigger1 = time = 32
anim = 3003
pos = -70, 0
postype = p1
bindtime = -1
scale = .5,5
ID = 3003
sprpriority = 3
supermovetime = 9999
ownpal = 1
persistent = 4

[State 3051, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = time = [16,31]
attr = S, HT
guardflag = H
hitflag = MAFD
animtype = back
damage = ceil(75*parent,FVar(0)),5
priority = 4, Hit
pausetime = 4, 4
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
ground.slidetime = 1
ground.hittime = 1
yaccel = .53
ground.velocity = 0
air.velocity = 0
down.velocity = 0
ground.cornerpush.veloff = 0
air.fall = 1
fall.yvelocity = 0
fall.recover = 0
kill = 0
getpower = 0, 0
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = StateNo
persistent = 2

[State 3051]
type = MoveHitReset
trigger1 = movecontact && time = 32

[State 3051, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = movecontact = 0 && movereversed = 0 && time > 31
attr = S, HP
guardflag = M
hitflag = MAFD
animtype = back
damage = ceil(345*parent,FVar(0))+50,45
priority = 4, Hit
pausetime = 0, 6
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s0, 10
guardsound = s1, 11
ground.type = Low
ground.slidetime = 18
guard.slidetime = 36
ground.hittime = 18
guard.hittime = 36
yaccel = .53
ground.velocity = -45
guard.velocity = -13.2
airguard.velocity = -2.4,-.8
air.velocity = -45
down.velocity = -45
ground.cornerpush.veloff = 0
p2stateno = 235
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(120*parent,fvar(11)), ceil(60*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State -1]
type = ParentVarSet
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
fvar(5) = parent,fvar(5)*.8
ignorehitpause = 1

[State -1]
type = ParentVarSet
trigger1 = time = 31
trigger1 = parent,fvar(5) < .65
fvar(5) = .65
ignorehitpause = 1

[State 3051]
type = Helper
trigger1 = time < 32 && hitpausetime = 3
trigger2 = time > 31 && MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = -Random%30, -10-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3051]
type = explod
trigger1 = time > 16
anim = 2806+random%6
pos = 40, 0
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 80,20
ID = 2806
sprpriority = 3
supermovetime = 9999
ownpal = 1
persistent = 6

[State 3051, エフェクト]
type = Explod
trigger1 = time = [33,35]
anim = 3005
ID = 3005
pos = -(time-31)*35, 20
postype = p1
scale = .5+(time-33)*.1, .5+(time-33)*.1
sprpriority = 3
ownpal = 1

[State 3051, エフェクト]
type = Explod
trigger1 = time > 32
anim = 103
ID = 103
pos = 0,20
postype = p1
sprpriority = 3
ownpal = 1

[State 3051, ヘルパーを消す]
type = DestroySelf
trigger1 = pos X != [-440,440]

;---------------------------------------------------------------------------
;LEVEL5-judgelight-
[Statedef 3100]
type = S
movetype = A
physics = S
ctrl = 0
anim = 3100
velset = 0,0
sprpriority = 2

[State 3100]
type = varset
trigger1 = time = 1
fvar(13) = (var(23)+3000)*.0001666666

[State 3100]
type = varset
trigger1 = time = 1
var(21) = 0

[State 3100]
type = powerset
trigger1 = time = 1
value = 0

[State 3100]
type = nothitby
trigger1 = 1
value = SCA

[State 3100]
type = TargetBind
trigger1 = time = 32
ID = stateno
pos = FrontEdgeDist-75,480

[State 3100]
type = PosAdd
trigger1 = time = 33
x = -280-BackEdgeDist
y = 480

[State 3100]
type = PosAdd
trigger1 = time = 200
x = 320
y = -480

[State 3100]
type = Width
trigger1 = time < 300
edge = FrontEdgeDist,BackEdgeDist

[State 3100, ヒット定義（投げ用）]
type = HitDef
triggerall = var(7) < 30
trigger1 = Time = 0
attr = S, HT
hitflag = MAFD
priority = 7, hit
sparkno = -1
p2stateno = 3101
guard.dist = 0
id = StateNo

[State 3100]
type = PlaySnd
trigger1 = time = 0 || time = 25 || time = 50 || time = 75 || time = 100 || time = 125 || time = 200
value = 3101, 0

[State 3100]
type = Explod
trigger1 = time = 0
anim = 3105
ID = 3105
pos = 33, 0
postype = p1
sprpriority = 3
ownpal = 1

[State 3100]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 33, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3100]
type = Explod
trigger1 = time = 25
anim = 3107
ID = 3107
pos = 32, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3100]
type = Explod
trigger1 = time = 25
anim = 3107
ID = 3107
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3100]
type = Explod
trigger1 = numtarget(stateno) > 0
trigger1 = time = 25
anim = 3106
ID = 3106
pos = 0, 0
postype = p2
scale = 2, 2
sprpriority = 3
ownpal = 1

[State 3100]
type = Explod
trigger1 = numtarget(stateno) > 0
trigger1 = time = 75
anim = 3107
ID = 3107
pos = 0, 0
postype = p2
scale = 2, 2
sprpriority = 3
ownpal = 1

[State 3100]
type = Helper
trigger1 = time = 50
name = "attack"
stateno = 3110
pos = -40, 0
postype = front
facing = -1
ownpal = 1
ID = 3110

[State 3100]
type = Helper
trigger1 = time = 75
name = "melt"
stateno = 3120
pos = 40, 0
postype = back
ownpal = 1
ID = 3120

[State 3100]
type = Helper
trigger1 = time = 100
name = "dark"
stateno = 3130
pos = -15, 0
postype = front
facing = -1
ownpal = 1
ID = 3130

[State 3100]
type = Helper
trigger1 = time = 125
name = "accel"
stateno = 3140
pos = 15, 0
postype = back
ownpal = 1
ID = 3140

[State 3100]
type = bgpalfx
trigger1 = time < 24
time = 1
mul = 248-time*8,248-time*8,248-time*8

[State 3100]
type = bgpalfx
trigger1 = time = [24,281]
time = 1
mul = 64,64,64

[State 3100]
type = ChangeAnim
trigger1 = Time = 200
value = 0

[State 3100]
type = Explod
trigger1 = Time = 200
anim = 3106
ID = 3106
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3100]
type = ChangeAnim
trigger1 = Time = 230
value = 3000

[State 3100]
type = Helper
trigger1 = AnimElemTime(4) = 0 && anim = 3000
stateno = 3002
pos = 12, -20
postype = p1
ID = 3002

[State 3100, 音を鳴らす]
type = PlaySnd
trigger1 = AnimElemTime(3) = 0 && anim = 3000
value = 0, 7

[State 3100]
type = Helper
trigger1 = AnimElemTime(6) = 0 && anim = 3000
name = "spark"
stateno = 3003
pos = -30, -20
postype = p1
ownpal = 1
ID = 3003
ignorehitpause=1

[State 3100]
type = varset
trigger1 = AnimElemTime(6) = 0 && anim = 3000 && var(21) != 3
var(6) = 450
ignorehitpause=1

[State 3100, 音を鳴らす]
type = PlaySnd
trigger1 = time = 298 || time = 308 || time = 323 || time = 328
value = 0, 5

[State 3100]
type = bgpalfx
trigger1 = time = [282,283]
time = 1
add = 256,256,256

[State 3100]
type = bgpalfx
trigger1 = time = [284,315]
time = 1
mul = (time-284)*8,(time-284)*8,(time-284)*8

[State 3100]
type = explod
trigger1 = time = [308,340]
anim = 2806+random%6
pos = 0, -25
postype = p1
facing = 1-random%2*2
vfacing = 1-random%2*2
random = 15,20
scale = .5,.5
ID = 2806
sprpriority = 3
supermovetime = 9999
ownpal = 1
removeongethit = 1
persistent = 6

[State 3100]
type = Changeanim
trigger1 = time = 370 && anim = 3000
value = 3001
persistent = 0

[State 3100, エフェクト]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 102
ID = 102
postype = p1
sprpriority = 3
supermovetime = 10
ownpal = 1

[State 3100, エフェクト]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 3004
ID = 3004
pos = 0, 0
postype = p1
sprpriority = 3
supermovetime = 100
ownpal = 1

[State 3100]
type = Explod
trigger1 = AnimElemTime(6) = 0 && anim = 3000
anim = 3111
ID = 3111
pos = 45, 0
postype = p1
facing = 1
sprpriority = 3
ownpal = 1

[State 3100, エフェクト]
type = Explod
trigger1 = time = 78
anim = 3006
ID = 3006
pos = 25, -22
postype = p1
scale = 1.25, .75
sprpriority = 3
supermovetime = 10
ownpal = 1

[State 3100, ステート変更]
type = ChangeState
trigger1 = animtime= 0 && anim = 3001
value = 0
ctrl = 1

[Statedef 3110];ぐんぱ
type    = S
movetype= I
physics = N
velset = 0,0
anim = 3110
ctrl = 0
sprpriority = 1

[State 3110]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3110]
type = nothitby
trigger1 = 1
value = SCA

[State 3110]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3110]
type = Explod
trigger1 = animtime = -5
anim = 3107
ID = 3107
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3110, エフェクト]
type = statetypeset
trigger1 = animelemno(0) = 4
movetype= A

[State 3110]
type = PlaySnd
trigger1 = animelemtime(6) = 0
value = 0, 11

[State 3110]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3005
ID = 3005
pos = 30, 0
postype = p1
facing = -1
scale = .5,.5
bindtime = -1
sprpriority = 2
ownpal = 1

[State 3110]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3111
ID = 3111
pos = 10, 0
postype = p1
facing = -1
bindtime = -1
sprpriority = 3
ownpal = 1

[State 3110, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = animelemtime(6) = 0
attr = S, SP
guardflag = M
hitflag = MAFD
damage = ceil(160*parent,FVar(0)*parent,FVar(13)),20
priority = 4, Hit
pausetime = 0, 16
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s0, 10
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .53
ground.velocity = -12
airguard.velocity = -1.6,-2.8
air.velocity = -12
down.velocity = -12
ground.cornerpush.veloff = 0
p2stateno = 235
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = StateNo

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 3110]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = -Random%30, -20-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3110]
type = PlaySnd
trigger1 = animtime = 0
value = 3101, 0

[State 3110]
type = DestroySelf
trigger1 = animtime = 0

[Statedef 3120];むぎのん
type    = S
movetype= I
physics = N
velset = 0,0
anim = 3120
ctrl = 0
sprpriority = 4

[State 3120]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3120]
type = nothitby
trigger1 = 1
value = SCA

[State 3120]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 0, 0
postype = p1
sprpriority = 6
ownpal = 1

[State 3120]
type = Explod
trigger1 = animtime = -5
anim = 3107
ID = 3107
pos = 0, 0
postype = p1
sprpriority = 6
ownpal = 1

[State 3120, エフェクト]
type = statetypeset
trigger1 = animelemno(0) = 5
movetype= A

[State 3120]
type = PlaySnd
trigger1 = animelemtime(6) = 0
value = 2, 5

[State 3120]
type = Explod
trigger1 = time = 0
anim = 3121
ID = 3121
pos = 4, -16
postype = p1
bindtime = -1
scale = .5, .5
sprpriority = 1
ownpal = 1

[State 3120]
type = Explod
trigger1 = time = 0
anim = 3122
ID = 3122
pos = -2, -27
postype = p1
bindtime = -1
scale = .5,.5
sprpriority = 6
ownpal = 1

[State 3120]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3125
ID = 3125
pos = 0, 0
postype = p1
bindtime = -1
sprpriority = 1
ownpal = 1

[State 3120]
type = Explod
trigger1 = animelemtime(6) = [2,6]
anim = 3126
ID = 3126
pos = 130-animelemtime(6)*25, 0
postype = p1
bindtime = -1
scale = .5,.5
sprpriority = 4
ownpal = 1

[State 3120, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = animelemno(0) = 6
attr = S, SA
guardflag = HA
hitflag = MAFD
damage = ceil(60*parent,FVar(0)*parent,FVar(13)),4
priority = 4, Hit
pausetime = 0, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 9
guardsound = s1, 11
ground.slidetime = 20
ground.hittime  = 20
guard.hittime  = 18
yaccel = .53
ground.velocity = -12
airguard.velocity = -1.6,-2.8
air.velocity = -12
down.velocity = -12
ground.cornerpush.veloff = 0
p2stateno = 235
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(40*parent,fvar(11)), ceil(20*parent,fvar(11))
id = StateNo
persistent = 6

[State -1]
type = ParentVarAdd
trigger1 = MoveHit = 1
var(14) = 1
ignorehitpause=1

[State 3120]
type = Helper
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
ignorehitpause=1
name = "hit spark"
stateno = 6051
pos = -Random%30, -20-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3120]
type = PlaySnd
trigger1 = animtime = -5
value = 3101, 0

[State 3120]
type = DestroySelf
trigger1 = animtime = 0

[Statedef 3130];ていとくん
type    = S
movetype= I
physics = N
velset = 0,0
anim = 3130
ctrl = 0
sprpriority = 3

[State 3130]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3130]
type = nothitby
trigger1 = 1
value = SCA

[State 3130]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3130]
type = Explod
trigger1 = animtime = -5
anim = 3107
ID = 3107
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3130]
type = velset
trigger1 = animelemtime(3) = 0
x = 1.5
y = -12.6

[State 3130]
type = veladd
trigger1 = vel y < 0
y = .18

[State 3130]
type = statetypeset
trigger1 = animelemtime(3) = 0
movetype= A
physics = A

[State 3130]
type = velset
trigger1 = vel y > 0
x = 0
y = 0

[State 3130]
type = PlaySnd
trigger1 = animelemtime(4) = 0
value = 2530, 0

[State 3130]
type = Explod
trigger1 = animelemtime(4) = 0
anim = 3131
ID = 3131
pos = 0, -10
postype = p1
sprpriority = 1
ownpal = 1

[State 3130]
type = Explod
trigger1 = animelemtime(4) = 4
anim = 3132
ID = 3132
pos = 0, -10
postype = p1
sprpriority = 4
ownpal = 1

[State 3130]
type = Explod
trigger1 = animelemtime(4) = 12
anim = 3133
ID = 3133
pos = 0, -10
postype = p1
sprpriority = 1
ownpal = 1

[State 3130]
type = Explod
trigger1 = animelemtime(4) = 28
anim = 3134
ID = 3134
pos = 0, -10
postype = p1
sprpriority = 1
ownpal = 1

[State 3130]
type = Helper
trigger1 = animelemno(0) = 5
ignorehitpause=1
name = "hit spark"
stateno = 3135
pos = 0, -10
postype = p1
supermovetime = 20
ownpal = 1
ID = 3135
persistent = 4

[State 3130, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = animelemno(0) = 5
attr = S, HA
guardflag = MA
hitflag = MAFD
damage = ceil(15*parent,FVar(0)*parent,FVar(13)),5
priority = 1, Hit
pausetime = 0, 3
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 4
guardsound = s1, 11
ground.type = Low
yaccel = .53
ground.velocity = -2.4,-7.8
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -1.6*parent,var(15)-1.6,ifelse(parent,var(15),parent,fvar(10),-4.8)
air.hittime = 12
down.velocity = -2.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(10*parent,fvar(11)), ceil(5*parent,fvar(11))
id = StateNo
persistent = 4

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 3130]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6002
pos = -Random%30, -20-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3130]
type = PlaySnd
trigger1 = animtime = -5
value = 3101, 0

[State 3130]
type = DestroySelf
trigger1 = animtime = 0

[Statedef 3135]
type    = S
movetype= I
physics = N
velset = 0,0
anim = 3135
ctrl = 0
sprpriority = 1

[State 3135]
type = assertspecial
trigger1 = 1
flag = noshadow

[State 3135]
type = trans
trigger1 = 1
trans = add

[State 3135]
type = angledraw
trigger1 = 1
scale = .5+.5*time,.5+.5*time

[State 3135]
type = palfx
trigger1 = 1
time = 1
add = -time*16,-time*16,-time*16
mul = random%512, random%512, random%512

[State 3135]
type = DestroySelf
trigger1 = animtime = 0

[Statedef 3140];あくせられーた
type    = S
movetype= I
physics = N
velset = 0,0
anim = 3140
ctrl = 0
sprpriority = 3

[State 3140]
type = hitoverride
trigger1 = 1
attr = SCA

[State 3140]
type = nothitby
trigger1 = 1
value = SCA

[State 3140]
type = Explod
trigger1 = time = 0
anim = 3106
ID = 3106
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3140]
type = Explod
trigger1 = animtime = -5
anim = 3107
ID = 3107
pos = 0, 0
postype = p1
sprpriority = 4
ownpal = 1

[State 3140]
type = velset
trigger1 = animelemtime(2) = 0
x = .8
y = -6.4

[State 3140]
type = veladd
trigger1 = vel y < 0
y = -.32

[State 3140]
type = statetypeset
trigger1 = animelemtime(2) = 0
movetype= A
physics = A

[State 3140]
type = velset
trigger1 = vel y > 0
x = 0
y = 0

[State 3140]
type = PlaySnd
trigger1 = animelemtime(6) = 0
value = 2530, 0

[State 3140]
type = Explod
trigger1 = animelemtime(6) = 0
anim = 3141
ID = 3141
pos = 0, -10
postype = p1
bindtime = -1
sprpriority = 2
ownpal = 1

[State 3140, ヒット定義]
type = HitDef
triggerall = parent,var(7) < 30
trigger1 = animelemno(0) = 6
attr = S, HA
hitflag = MAFD
damage = ceil(30*parent,FVar(0)*parent,FVar(13))
priority = 1, Hit
pausetime = 0, 8
sparkno = -1
guard.sparkno = S6100
sparkxy = -Random%30, -10-Random%30
hitsound = s1, 5
guardsound = s1, 11
ground.type = Low
yaccel = .53
ground.velocity = -2.4,-7.8
airguard.velocity = -2.4,-.8
air.type = High
air.velocity = -1.4*parent,var(15)-1.4,ifelse(parent,var(15),parent,fvar(10),-7.8)
air.hittime = 12
down.velocity = -2.8,-2.5
ground.cornerpush.veloff = 0
fall = 1
fall.yvelocity = 0
fall.recover = 0
getpower = 0, 0
givepower = ceil(10*parent,fvar(11)), ceil(5*parent,fvar(11))
id = StateNo
persistent = 6

[State -1]
type = ParentVarAdd
trigger1 = MoveHit
trigger1 = NumTarget(StateNo)
trigger1 = target(StateNo),GetHitVar(damage) > 0
var(14) = 1
ignorehitpause=1

[State 3140]
type = Helper
trigger1 = MoveHit = 1
ignorehitpause=1
name = "hit spark"
stateno = 6051
pos = -Random%30, -20-Random%30
postype = p2
supermovetime = 20
ownpal = 1
ID = 6000

[State 3140]
type = PlaySnd
trigger1 = animtime = -5
value = 3101, 0

[State 3140]
type = DestroySelf
trigger1 = animtime = 0

;---------------------------------------------------------------------------
[Statedef 3101]
type= U
movetype= U
physics = N
ctrl = 0
sprpriority = 2
facep2 = 1

[State 3101]
type = assertspecial
trigger1 = time = [28,75]
flag = invisible
flag2 = noshadow

[State 3101]
type = nothitby
trigger1 = time = [0,75]
value = SCA

[State 3101]
type = posfreeze
trigger1 = 1
value = 1

[State 3101]
type = PosAdd
trigger1 = time = 73
y = -pos Y

[State 3101, 相手のアニメ変更]
type = ChangeAnim
trigger1 = time = [0,100]
value = anim
elem = animelemno(0)

[State 3101, 相手のアニメ変更]
type = ChangeAnim
trigger1 = animtime = 0 && time > 100
value = 0

[State 3101, ステート変更]
type = SelfState
trigger1 = anim = 0 && time > 100
value = 0
ctrl = 1

;===========================================================================
; 準常時監視ステート（‐３）
;===========================================================================

[Statedef -3]

;Gethit sounds
[State -3, Get Hit Sounds]
type = PlaySnd
triggerall = alive && time = 1
trigger1 = (stateno = 5000 || stateno = 5010 || stateno = 5020 || stateno = 5070 || stateno = 5080)
trigger1 = enemynear,hitdefattr = SCA,NA,SA,HA
value = S5000,0+(random%2)
volume = 255
channel = 0

[State 3101, ステート変更]
type = null
trigger1 = 0

;---------------------------------------------------------------------------
